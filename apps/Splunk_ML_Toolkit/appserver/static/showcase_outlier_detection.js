webpackJsonp([18],{0:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__webpack_require__.p=function(){function make_url(){for(var seg,len,output="",i=0,l=arguments.length;i<l;i++)seg=arguments[i].toString(),len=seg.length,len>1&&"/"==seg.charAt(len-1)&&(seg=seg.substring(0,len-1)),output+="/"!=seg.charAt(0)?"/"+seg:seg;if("/"!=output){var segments=output.split("/"),firstseg=segments[1];if("static"==firstseg||"modules"==firstseg){var postfix=output.substring(firstseg.length+2,output.length);output="/"+firstseg,window.$C.BUILD_NUMBER&&(output+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(output+="."+window.$C.BUILD_PUSH_NUMBER),"app"==segments[2]&&(output+=":"+getConfigValue("APP_BUILD",0)),output+="/"+postfix}}var root=getConfigValue("MRSPARKLE_ROOT_PATH","/"),djangoRoot=getConfigValue("DJANGO_ROOT_PATH",""),locale=getConfigValue("LOCALE","en-US"),combinedPath="";return combinedPath=djangoRoot&&output.substring(0,djangoRoot.length)===djangoRoot?output.replace(djangoRoot,djangoRoot+"/"+locale.toLowerCase()):"/"+locale+output,""==root||"/"==root?combinedPath:root+combinedPath}function getConfigValue(key,defaultValue){if(window.$C&&window.$C.hasOwnProperty(key))return window.$C[key];if(void 0!==defaultValue)return defaultValue;throw new Error("getConfigValue - "+key+" not set, no default provided")}return make_url("/static/app/Splunk_ML_Toolkit/")+"/"}(),__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__(513),__webpack_require__("splunkjs/mvc/chartview"),__webpack_require__("splunkjs/mvc/checkboxview"),__webpack_require__("splunkjs/mvc/dropdownview"),__webpack_require__("splunkjs/mvc/tableview"),__webpack_require__("splunkjs/mvc/utils"),__webpack_require__("splunkjs/mvc/visualizationregistry"),__webpack_require__(620),__webpack_require__(624),__webpack_require__(595),__webpack_require__(625),__webpack_require__(547),__webpack_require__(626),__webpack_require__(509),__webpack_require__(596),__webpack_require__(672),__webpack_require__(546),__webpack_require__(628),__webpack_require__(643),__webpack_require__(541),__webpack_require__(629),__webpack_require__(630),__webpack_require__(631)],__WEBPACK_AMD_DEFINE_RESULT__=function(_jquery,_underscoreMltk,_chartview,_checkboxview,_dropdownview,_tableview,_utils,_visualizationregistry,_Master,_DrilldownLinker,_Messages,_SearchStringDisplay,_compactTemplateString,_ColorPalette,_Options,_NumberValidator,_TimestampValidator,_OutlierDetection,_EnhancedMultiDropdownView,_EnhancedTextInputView,_Forms,_Searches,_TableUtils,_BaseAssistantView){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function _taggedTemplateLiteral(strings,raw){return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _jquery2=_interopRequireDefault(_jquery),_underscoreMltk2=_interopRequireDefault(_underscoreMltk),_chartview2=_interopRequireDefault(_chartview),_checkboxview2=_interopRequireDefault(_checkboxview),_dropdownview2=_interopRequireDefault(_dropdownview),_tableview2=_interopRequireDefault(_tableview),_utils2=_interopRequireDefault(_utils),_Master2=_interopRequireDefault(_Master),DrilldownLinker=_interopRequireWildcard(_DrilldownLinker),Messages=_interopRequireWildcard(_Messages),_compactTemplateString2=_interopRequireDefault(_compactTemplateString),_Options2=_interopRequireDefault(_Options),NumberValidator=_interopRequireWildcard(_NumberValidator),_OutlierDetection2=_interopRequireDefault(_OutlierDetection),_EnhancedMultiDropdownView2=_interopRequireDefault(_EnhancedMultiDropdownView),_EnhancedTextInputView2=_interopRequireDefault(_EnhancedTextInputView),Forms=_interopRequireWildcard(_Forms),Searches=_interopRequireWildcard(_Searches),TableUtils=_interopRequireWildcard(_TableUtils),_BaseAssistantView2=_interopRequireDefault(_BaseAssistantView),_slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_templateObject=_taggedTemplateLiteral(['| loadjob $searchBarSearchJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column\n                               | search column != "column" AND column != "_*"'],['| loadjob $searchBarSearchJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column\n                               | search column != "column" AND column != "_*"']),_templateObject2=_taggedTemplateLiteral(['| loadjob $outlierVariableSearchToken$\n                                           | search column != "column" AND column != $outlierVariableToken|s$ AND (column != "_*" OR column = "_time")'],['| loadjob $outlierVariableSearchToken$\n                                           | search column != "column" AND column != $outlierVariableToken|s$ AND (column != "_*" OR column = "_time")']),OutlierDetectionView=_BaseAssistantView2.default.extend({headerOptions:{title:"Detect Numeric Outliers",description:"Find values that differ significantly from previous values."},submitButtonText:"Detect Outliers",searchBarTooltip:"The events returned should contain at least one numeric field.",historyStatisticsFields:["outlierCount"],activateSaveTooltip:"To activate Save, successfully detect outliers.",renderPanels:function(){function getOutlierDetectionType(){var mainSearchStage=self.model.experiment.getMainSearchStageModel(),windowSize=mainSearchStage.get("windowSize");return""+mainSearchStage.get("thresholdMethod")+(null!=windowSize&&windowSize>0?"_Windowed":"")}function getFullSearchQueryArray(){var outliersFilterType=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"both",fullSearchQueryArray=[],outlierSearchQuery=outlierSearchSettings[getOutlierDetectionType()],searchInfo=self.getSearchInfo();if(null!=searchInfo.searchString&&null!=outlierSearchQuery){fullSearchQueryArray[0]=searchInfo.searchString;for(var i=0;i<outlierSearchQuery.search.length;i++)fullSearchQueryArray[i+1]=outlierSearchQuery.search[i];fullSearchQueryArray.push(outlierFieldSearchStrings[outliersFilterType])}return fullSearchQueryArray}function getFullSearchQueryComments(){return[null].concat(outlierSearchSettings[getOutlierDetectionType()].description,["mark values outside the bounds as outliers"])}function updateForm(newIsRunningValue){null!=newIsRunningValue&&(isRunning=newIsRunningValue),self.controls.outlierVariableControl.settings.set("disabled",isRunning),self.controls.thresholdMethodControl.settings.set("disabled",isRunning),self.controls.thresholdMultiplierControl.settings.set("disabled",isRunning),self.controls.windowedAnalysisCheckboxControl.settings.set("disabled",isRunning);var windowingControlsEnabled=isRunning||!self.controls.windowedAnalysisCheckboxControl.val();if(self.controls.windowSizeControl.settings.set("disabled",windowingControlsEnabled),self.controls.currentPointCheckboxControl.settings.set("disabled",windowingControlsEnabled),self.controls.splitByFieldsControl.settings.set("disabled",isRunning),isRunning)self.model.state.set({footerDisabled:isRunning,submitButtonText:"Detecting Outliers..."}),submitted&&self.model.state.trigger("submitStarted");else{var outlierVariableToken=Forms.getToken("outlierVariableToken"),fieldsValid=null!=outlierVariableToken&&outlierVariableToken.length>0;self.model.state.set({footerDisabled:!fieldsValid,submitButtonText:self.submitButtonText}),fieldsValid&&submitted&&(submitSuccess&&(self.model.experimentSubmitPristine.setFromSplunkD(self.model.experiment.toSplunkD()),self.model.state.trigger("submitSuccess"),submitSuccess=!1),submitted=!1)}}function getVizQuery(){var sharedSearchArray=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],outliersFilterType=arguments[1],searchInfo=self.getSearchInfo(),vizQueryArray=getFullSearchQueryArray(outliersFilterType).concat(sharedSearchArray),vizQuerySearch=DrilldownLinker.createSearch(vizQueryArray,searchInfo.timeRange);return[vizQueryArray,vizQuerySearch]}function updateWindowSize(){updateForm();var isWindowed=self.controls.windowedAnalysisCheckboxControl.val(),windowSizeValid=self.controls.windowSizeControl.validate()||!isWindowed;self.controlValidity.set(self.controls.windowSizeControl.id,windowSizeValid);var windowSize=self.controls.windowSizeControl.val();self.model.experiment.getMainSearchStageModel().set("windowSize",isWindowed?windowSize:void 0),Forms.setToken("windowSizeToken",windowSize)}var _this=this,self=this;_BaseAssistantView2.default.prototype.renderPanels.call(this);var _utils$getPageInfo=_utils2.default.getPageInfo(),appName=_utils$getPageInfo.app,isRunning=!1,submitted=!1,submitSuccess=!1,outlierSearchSettings={stdev_Windowed:{search:["| streamstats window=$windowSizeToken$ current=$useCurrentPointToken$ avg($outlierVariableToken|s$) as avg stdev($outlierVariableToken|s$) as stdev $splitByFieldsQueryToken$","| eval lowerBound=(avg-stdev*exact($thresholdMultiplierToken$)), upperBound=(avg+stdev*exact($thresholdMultiplierToken$))"],description:["calculate the mean and standard deviation using a sliding window","calculate the bounds as a multiple of the standard deviation"]},MAD_Windowed:{search:["| streamstats window=$windowSizeToken$ current=$useCurrentPointToken$ median($outlierVariableToken|s$) as median $splitByFieldsQueryToken$","| eval absDev=(abs('$outlierVariableToken$'-median))","| streamstats window=$windowSizeToken$ current=$useCurrentPointToken$ median(absDev) as medianAbsDev $splitByFieldsQueryToken$","| eval lowerBound=(median-medianAbsDev*exact($thresholdMultiplierToken$)), upperBound=(median+medianAbsDev*exact($thresholdMultiplierToken$))"],description:["calculate the median value using a sliding window","calculate the absolute deviation of each value from the median","use the same sliding window to compute the median absolute deviation","calculate the bounds as a multiple of the median absolute deviation"]},IQR_Windowed:{search:["| streamstats window=$windowSizeToken$ current=$useCurrentPointToken$ median($outlierVariableToken|s$) as median p25($outlierVariableToken|s$) as p25 p75($outlierVariableToken|s$) as p75 $splitByFieldsQueryToken$","| eval IQR=(p75-p25)","| eval lowerBound=(median-IQR*exact($thresholdMultiplierToken$)), upperBound=(median+IQR*exact($thresholdMultiplierToken$))"],description:["calculate the first, second, and third quartiles using a sliding window","calculate the interquartile range","calculate the bounds as a multiple of the interquartile range"]},stdev:{search:["| eventstats avg($outlierVariableToken|s$) as avg stdev($outlierVariableToken|s$) as stdev $splitByFieldsQueryToken$","| eval lowerBound=(avg-stdev*exact($thresholdMultiplierToken$)), upperBound=(avg+stdev*exact($thresholdMultiplierToken$))"],description:["calculate the mean and standard deviation","calculate the bounds as a multiple of the standard deviation"]},MAD:{search:["| eventstats median($outlierVariableToken|s$) as median $splitByFieldsQueryToken$","| eval absDev=(abs('$outlierVariableToken$'-median))","| eventstats median(absDev) as medianAbsDev $splitByFieldsQueryToken$","| eval lowerBound=(median-medianAbsDev*exact($thresholdMultiplierToken$)), upperBound=(median+medianAbsDev*exact($thresholdMultiplierToken$))"],description:["calculate the median","calculate the absolute deviation of each value from the median","use the same sliding window to compute the median absolute deviation","calculate the bounds as a multiple of the median absolute deviation"]},IQR:{search:["| eventstats median($outlierVariableToken|s$) as median p25($outlierVariableToken|s$) as p25 p75($outlierVariableToken|s$) as p75 $splitByFieldsQueryToken$","| eval IQR=(p75-p25)","| eval lowerBound=(median-IQR*exact($thresholdMultiplierToken$)), upperBound=(median+IQR*exact($thresholdMultiplierToken$))"],description:["calculate the first, second, and third quartiles","calculate the interquartile range","calculate the bounds as a multiple of the interquartile range"]}},outlierFieldSearchStrings={both:"| eval isOutlier=if('$outlierVariableToken$' < lowerBound OR '$outlierVariableToken$' > upperBound, 1, 0)",above:"| eval isOutlier=if('$outlierVariableToken$' > upperBound, 1, 0)",below:"| eval isOutlier=if('$outlierVariableToken$' < lowerBound, 1, 0)",split:"| eval isOutlierBelow=if('$outlierVariableToken$' < lowerBound, 1, 0), isOutlierAbove=if('$outlierVariableToken$' > upperBound, 1, 0)"};this.controls.thresholdMethodControl=function(){var methodVariables={stdev:{deviation:"stdev",midPoint:"avg"},MAD:{deviation:"medianAbsDev",midPoint:"median"},IQR:{deviation:"IQR",midPoint:"median"}},control=new _dropdownview2.default({id:"thresholdMethodControl",el:_this.$el.find("#thresholdMethodControl"),labelField:"label",valueField:"value",showClearButton:!1,choices:[{value:"stdev",label:"Standard Deviation"},{value:"MAD",label:"Median Absolute Deviation"},{value:"IQR",label:"Interquartile Range"}]});return control.$el.prev("label").tooltip({title:"Select the method to use, depending on the characteristics of the data and the outliers you want to find. For example, Median Absolute Deviation is more robust to outliers than Standard Deviation."}),control.on("change",function(value){self.model.experiment.getMainSearchStageModel().set("thresholdMethod",value),Forms.setToken("thresholdDeviationToken",methodVariables[value].deviation),Forms.setToken("thresholdMidpointToken",methodVariables[value].midPoint)}),control.render(),control}(),this.controls.thresholdMultiplierControl=function(){var control=new _EnhancedTextInputView2.default({id:"thresholdMultiplierControl",el:_this.$el.find("#thresholdMultiplierControl"),validator:{type:"number",min:0,minExclusive:!0,message:"Multiplier must be a number greater than zero."}});return control.$el.prev("label").tooltip({title:"Adjust this value until the number of outliers matches your needs."}),self.controlValidity.set(control.id,!1),control.on("change",function(value){self.model.experiment.getMainSearchStageModel().set("thresholdMultiplier",value),self.controlValidity.set(control.id,!control.settings.get("invalid")),Forms.setToken("thresholdMultiplierToken",value),updateForm()}),control.render(),control}(),this.controls.windowSizeControl=function(){var control=new _EnhancedTextInputView2.default({id:"windowSizeControl",el:_this.$el.find("#windowSizeControl"),validator:{type:"number",min:0,minExclusive:!0,allowFloats:!1,message:"Number of samples must be a positive integer."}});return control.$el.prev(".checkbox").children("label").tooltip({title:"Use a sliding window if the distribution of your data changes frequently."}),control.on("change",updateWindowSize),control.render(),control}(),self.controls.windowedAnalysisCheckboxControl=function(){var control=new _checkboxview2.default({id:"windowedAnalysisCheckboxControl",el:_this.$el.find("#windowedAnalysisCheckboxControl")});return control.on("change",updateWindowSize),control.render(),control}(),this.controls.currentPointCheckboxControl=function(){var control=new _checkboxview2.default({id:"currentPointCheckboxControl",el:_this.$el.find("#currentPointCheckboxControl"),value:!0});return control.$el.next("label").tooltip({title:"When selected, the threshold method will include the current point in the statistical calculations before assessing whether it is an outlier."}),control.on("change",function(useCurrent){self.model.experiment.getMainSearchStageModel().set("useCurrentPoint",useCurrent),Forms.setToken("useCurrentPointToken",useCurrent)}),control.render(),control}(),this.$el.find("#"+this.controls.windowSizeControl.getInputId()).after(this.controls.currentPointCheckboxControl.$el.parent()),self.controls.splitByFieldsControl=function(){function updateSplitByFieldsTokens(){var splitByFields=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],isSplit=splitByFields.length>0;Forms.setToken("splitByFieldsToken",splitByFields);var splitByEvalPairs=splitByFields.map(function(splitByField){var fieldName=Forms.escape(" "+splitByField+"="),fieldValue="'"+splitByField+"'";return fieldName+" + "+fieldValue});Forms.setToken("splitByEvalToken",isSplit?"| eval _combined_split_by="+splitByEvalPairs.join(" + "):""),Forms.setToken("outliersOverTimeSplitByToken",isSplit?" by "+splitByEvalField:"");var escapedSplitByFields=splitByFields.map(Forms.escape);Forms.setToken("splitByFieldsQueryToken",isSplit?" by "+escapedSplitByFields.join(", "):""),Forms.setToken("splitByMacroToken",isSplit?"| `splitby("+escapedSplitByFields.join(", ")+")`":"")}var control=new _EnhancedMultiDropdownView2.default({id:"splitByFieldsControl",managerid:"splitByFieldsSearch",el:_this.$el.find("#splitByFieldsControl"),labelField:"column",valueField:"column",width:300,maximumSelectionSize:5,placeholder:"(optional)"});control.$el.prev("label").tooltip({title:"Select the categorical fields to split by. Outliers will be detected for each (combination of) distinct values."});var splitByEvalField="_combined_split_by";return control.on("change",function(){var splitByFields=control.val();self.model.experiment.getMainSearchStageModel().splitByFields.resetFields(splitByFields),updateSplitByFieldsTokens(splitByFields)}),updateSplitByFieldsTokens(),control.render(),control}(),self.controls.outlierVariableControl=function(){var control=new _dropdownview2.default({id:"outlierVariableControl",managerid:"outlierVariableSearch",el:_this.$el.find("#outlierVariableControl"),labelField:"column",valueField:"column",showClearButton:!1});return control.$el.prev("label").tooltip({title:"Select the numeric field in which to detect outliers."}),control.on("change",function(){var outlierField=this.val();self.model.experiment.getMainSearchStageModel().outlierFields.resetFields(_underscoreMltk2.default.asArray(outlierField)),Forms.setToken("outlierVariableToken",outlierField),Forms.clearChoiceView(self.controls.splitByFieldsControl),updateForm()}),control.render(),control}();var outliersVizPanel=function(){var vizName="OutliersViz",OutliersViz=(0,_visualizationregistry.getVisualizer)(appName,vizName),assistantPanel=new _Master2.default({el:_this.$el.find("#outliersPanel"),title:"Data and Outliers",tooltip:"Values that fall outside the outlier bounds (shown in blue) are considered outliers (yellow dots). Adjust the threshold method or multiplier until the outliers match your expectations.",viz:OutliersViz,vizOptions:_defineProperty({id:"outliersViz",height:_Options2.default.getOptionByName("defaultVizHeight"),managerid:"outliersVizSearch"},appName+"."+vizName+".onClick",function(point){if(!isNaN(point.y)){var yValue=null!=point.originalY?Forms.escape(point.originalY):Forms.escape(point.y),searchQuery=getFullSearchQueryArray().concat([" | search $outlierVariableToken|s$="+yValue]),searchInfo=self.getSearchInfo(),search=DrilldownLinker.createSearch(searchQuery,searchInfo.timeRange);window.open(DrilldownLinker.getUrl("search",search),"_blank")}})});return assistantPanel}(),outliersOverTimeVizPanel=function(){var managerId="outliersOverTimeVizSearch",assistantPanel=new _Master2.default({el:_this.$el.find("#outliersOverTimePanel"),title:"Outlier Count Over Time",tooltip:"Shows the number of outliers over time.",viz:_chartview2.default,vizOptions:{id:"outliersOverTimeViz",managerid:managerId,type:"column","charting.chart.stackMode":"stacked",drilldownRedirect:!1}});assistantPanel.viz.on("drilldown",function(e){e.event&&e.drilldown&&(e.event.modifierKey=!0,e.drilldown())});var splitOutliersLabel=(0,_jquery2.default)('<label class="checkbox">');return splitOutliersLabel.insertAfter(assistantPanel.header),splitOutliersLabel.tooltip({title:"Shows outliers above the upper threshold separately from those below the lower threshold.",container:"body"}),assistantPanel.splitOutliersCheckboxControl=new _checkboxview2.default({id:"splitOutliersCheckboxControl",el:splitOutliersLabel,value:!1}).render(),assistantPanel.splitOutliersCheckboxControl.on("change",function(){Forms.setToken("outliersOverTimeToken",this.val()?'sum(isOutlierAbove) as "outliers above", sum(isOutlierBelow) as "outliers below"':"sum(isOutlier) as outliers"),Searches.getSearchManager(managerId).cancel().startSearch()}),splitOutliersLabel.append((0,_jquery2.default)("<span>").text("Split outliers above and below threshold")),assistantPanel}(),outliersTablePanel=function(){var assistantPanel=new _Master2.default({el:_this.$el.find("#outliersTablePanel"),title:"Data and Outliers",viz:_tableview2.default,vizOptions:{id:"outliersTable",managerid:"outliersVizSearch",sortKey:"isOutlier",sortDirection:"desc",drilldown:"none"}}),HighlightedTableRender=_tableview2.default.BaseCellRenderer.extend({canRender:function(){return!0},teardown:function(){this.outlierEventTriggered=!1},render:function($td,cell){if($td.text(cell.value),"isOutlier"===cell.field){var icon="check",colorIndex=7;"1"===cell.value&&(icon="alert",colorIndex=1,$td.attr("data-outlier",!0),this.outlierEventTriggered||(assistantPanel.viz.trigger("outlierFound"),this.outlierEventTriggered=!0)),$td.addClass("icon-inline").html(_underscoreMltk2.default.template('<i class="icon-<%-icon%>" style="color: <%-color%>"></i> &#160 <%- text %> ',{icon:icon,text:cell.value,color:(0,_ColorPalette.getColorByIndex)(colorIndex)}))}else cell.field===Forms.getToken("outlierVariableToken")&&$td.attr("data-outlier-variable",!0);$td.addClass(TableUtils.columnTypeToClassName(cell.columnType))}});return assistantPanel.viz.addCellRenderer(new HighlightedTableRender),assistantPanel.viz.on("outlierFound",function(){_underscoreMltk2.default.defer(function(){assistantPanel.viz.$el.find("tbody tr td[data-outlier]").siblings("td[data-outlier-variable]").css("background-color",(0,_ColorPalette.getColorByIndex)(1))})}),assistantPanel}(),outliersDistributionVizPanel=function(){var _vizOptions2,vizName="HistogramViz",HistogramViz=(0,_visualizationregistry.getVisualizer)(appName,vizName);return new _Master2.default({el:_this.$el.find("#outliersBarChartPanel"),title:"Data Distribution",tooltip:"The distance from the measure of centrality in units of threshold multiples. Values within the outlier bounds are shown inside the highlighted area.",viz:HistogramViz,vizOptions:(_vizOptions2={id:"outliersBarChartViz",managerid:"outliersBarChartVizSearch",height:400},_defineProperty(_vizOptions2,appName+"."+vizName+".yAxisLogarithmic",!0),_defineProperty(_vizOptions2,appName+"."+vizName+".columnPadding",!0),_defineProperty(_vizOptions2,appName+"."+vizName+".areaLabel","points within threshold"),_vizOptions2)})}(),outliersSplitCountPanel=function(){return new _Master2.default({el:_this.$el.find("#outliersSplitCountPanel"),title:"Outlier Split Value Distribution",tooltip:"The number of outliers per (combination of) split values.",viz:_tableview2.default,vizOptions:{id:"outliersSplitCountTable",managerid:"outliersSplitCountSearch"}})}();return this.listenTo(this.model.state,"submit",function(){if(!self.model.state.get("footerDisabled")&&self.controlValidity.getAll()){var outlierSearch=Searches.getSearchManager("outlierSearch");outlierSearch.cancel(),Searches.setSearchString(outlierSearch,["| loadjob $searchBarSearchJobIdToken$"].concat(outlierSearchSettings[getOutlierDetectionType()].search,[outlierFieldSearchStrings.both]).join(" ")),outlierSearch.startSearch(),submitted=!0}}),this.assistantFormView.searchBarControl.events.on("change",function(){Forms.clearChoiceView(self.controls.outlierVariableControl,!0),Forms.unsetToken("outlierVariableToken"),updateForm()}),function(){var searchBarSearch=Searches.getSearchManager("searchBarSearch");searchBarSearch.on("onStartCallback",function(){self.hideErrorMessage(),self.hideResults()}),searchBarSearch.on("onDoneCallback",function(searchManager){Searches.startSearch("outlierVariableSearch")}),searchBarSearch.on("onErrorCallback",function(errorMessage){Forms.clearChoiceViewOptions(self.controls.outlierVariableControl),self.showErrorMessage(errorMessage),self.hideResults()})}(),function(){Searches.setSearch("outlierVariableSearch",{searchString:(0,_compactTemplateString2.default)(_templateObject),targetJobIdTokenName:"outlierVariableSearchToken",onStartCallback:function(){self.hideErrorMessage()},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()}})}(),function(){Searches.setSearch("splitByFieldsSearch",{searchString:(0,_compactTemplateString2.default)(_templateObject2),onDoneCallback:function(){0===Searches.getResultCount(this)&&self.controls.splitByFieldsControl.trigger("datachange-zero")},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()}})}(),function(){function openInSearch(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}function showSPL(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("outliersTableSearchModal","Calculate the outliers",vizQueryArray,getFullSearchQueryComments(),searchInfo.timeRange)}function onErrorCallback(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()}var vizQuerySearch=null,vizQueryArray=[];self.listenTo(self.model.state,"openInSearch",openInSearch),self.listenTo(self.model.state,"showSPL",showSPL),outliersTablePanel.openInSearchButton.on("click",openInSearch),outliersTablePanel.showSPLButton.on("click",showSPL),Searches.setSearch("outlierSearch",{autostart:!1,searchString:"",targetJobIdTokenName:"outlierSearchToken",onStartCallback:function(){self.hideErrorMessage(),updateForm(!0);var _getVizQuery=getVizQuery(),_getVizQuery2=_slicedToArray(_getVizQuery,2);vizQueryArray=_getVizQuery2[0],vizQuerySearch=_getVizQuery2[1],DrilldownLinker.setSearchDrilldown(outliersTablePanel.title,vizQuerySearch)},onDoneCallback:function(){self.showResults(),submitSuccess=!0},onDataCallback:function(data){self.accumulateExperimentHistory(Searches.getSid(this));var outlierVariableToken=Forms.getToken("outlierVariableToken"),outlierVariableIndex=data.fields.indexOf(outlierVariableToken),nonNumeric=data.rows.every(function(row){return!NumberValidator.validate(row[outlierVariableIndex])});if(nonNumeric)onErrorCallback('All values in "'+outlierVariableToken+'" are non-numeric. You may be able to analyze this data in the "Detect Categorical Outliers" assistant.'),self.showDatasetPreview();else{Searches.startSearch("outliersVizSearch"),Searches.startSearch("outliersBarChartVizSearch");var showOutliersOverTimeViz=null!=data&&null!=data.fields&&(0,_TimestampValidator.checkDataForTimestamps)(data.rows,data.fields.indexOf("_time"));showOutliersOverTimeViz?(outliersOverTimeVizPanel.show(),outliersOverTimeVizPanel.splitOutliersCheckboxControl.trigger("change")):outliersOverTimeVizPanel.hide();var showSplitByFieldsRow=Forms.getToken("splitByFieldsToken").length>0;showSplitByFieldsRow?(outliersSplitCountPanel.show(),Searches.startSearch("outliersSplitCountSearch")):outliersSplitCountPanel.hide(!0)}},onErrorCallback:onErrorCallback,onFinallyCallback:function(){updateForm(!1)}})}(),function(){Searches.setSearch("outliersCountSearch",{autostart:!0,targetJobIdTokenName:"outliersCountSearchToken",searchString:"| loadjob $outlierSearchToken$ | where isOutlier=1 | stats count as outlierCount",onDataCallback:function(data){self.accumulateExperimentStatistics(Searches.getSid("outlierSearch"),data)}})}(),function(){var sharedSearchArray=["$splitByMacroToken$","| fields _time, $outlierVariableToken|s$, lowerBound, upperBound, isOutlier, *"],vizQuerySearch=null,vizQueryArray=[],vizOptions=DrilldownLinker.parseVizOptions({category:"custom",type:appName+".OutliersViz"});outliersVizPanel.openInSearchButton.on("click",function(){return window.open(DrilldownLinker.getUrl("search",vizQuerySearch,vizOptions),"_blank")}),outliersVizPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("outliersVizSearchModal","Plot the outliers",vizQueryArray,getFullSearchQueryComments().concat(["use the `splitby()` macro to configure the visualization to display a split view","format the columns to be in the order expected by the Outliers Plot visualization"]),searchInfo.timeRange,vizOptions)}),Searches.setSearch("outliersVizSearch",{autostart:!1,searchString:["| loadjob $outlierSearchToken$"].concat(sharedSearchArray),onStartCallback:function(){outliersVizPanel.showLoadingOverlay();var _getVizQuery3=getVizQuery(sharedSearchArray),_getVizQuery4=_slicedToArray(_getVizQuery3,2);vizQueryArray=_getVizQuery4[0],vizQuerySearch=_getVizQuery4[1],DrilldownLinker.setSearchDrilldown(outliersVizPanel.title,vizQuerySearch,vizOptions)},onDataCallback:function(data){if(null!=data&&null!=data.fields&&null!=data.rows&&data.rows.length>0){var tableFields=data.fields.slice(0,5),timeIndex=tableFields.indexOf("_time"),hasTimestamps=timeIndex>=0&&null!=data.rows[0][timeIndex],spliced=tableFields.splice(timeIndex,1);hasTimestamps&&tableFields.splice.apply(tableFields,_toConsumableArray([tableFields.length,0].concat(spliced)));var splitByFieldsToken=Forms.getToken("splitByFieldsToken");tableFields.splice.apply(tableFields,_toConsumableArray([tableFields.length,0].concat(splitByFieldsToken))),outliersTablePanel.viz.settings.set("fields",tableFields)}},onFinallyCallback:function(){outliersVizPanel.hideLoadingOverlay()}})}(),function(){var sharedSearchArray=["$splitByEvalToken$","| timechart $outliersOverTimeToken$ $outliersOverTimeSplitByToken$"],vizQueryArray=[],vizQuerySearch=null,vizOptions=DrilldownLinker.parseVizOptions({category:"charting",type:"column"});vizOptions["display.visualizations.charting.chart.stackMode"]="stacked",outliersOverTimeVizPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQueryArray,vizOptions),"_blank")}),outliersOverTimeVizPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("outliersOverTimeVizSearchModal","Plot the outlier count over time",vizQueryArray,getFullSearchQueryComments().concat(["combine the split-by fields into a single field for timechart","plot the outlier count over time"]),searchInfo.timeRange,vizOptions)}),Searches.setSearch("outliersOverTimeVizSearch",{autostart:!1,searchString:["| loadjob $outlierSearchToken$"].concat([outlierFieldSearchStrings.split],sharedSearchArray),onStartCallback:function(){outliersOverTimeVizPanel.showLoadingOverlay();var _getVizQuery5=getVizQuery(sharedSearchArray,outliersOverTimeVizPanel.splitOutliersCheckboxControl.val()?"split":"both"),_getVizQuery6=_slicedToArray(_getVizQuery5,2);vizQueryArray=_getVizQuery6[0],vizQuerySearch=_getVizQuery6[1],DrilldownLinker.setSearchDrilldown(outliersOverTimeVizPanel.title,vizQuerySearch,vizOptions)},onFinallyCallback:function(){outliersOverTimeVizPanel.hideLoadingOverlay()}})}(),function(){function getVizOptions(){return DrilldownLinker.parseVizOptions({category:"custom",type:outliersDistributionVizPanel.viz.settings.attributes.type},outliersDistributionVizPanel.getVizOptions())}var vizQueryArray=[],vizQuerySearch=null,methodDeviationLabels={
stdev:"standard deviations from mean",MAD:"median absolute deviations from median",IQR:"interquartile ranges from median"};outliersDistributionVizPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQueryArray,getVizOptions()),"_blank")}),outliersDistributionVizPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("outliersBarChartVizSearchModal","Plot the data distribution",vizQueryArray,getFullSearchQueryComments().concat(["get the outlier distance from the appropriate bound","convert the distance to multiples of the threshold","chart the distance over the count"]),searchInfo.timeRange,getVizOptions())});var sharedSearchArray=["| eval distance = max('$outlierVariableToken$' - $thresholdMidpointToken$, $thresholdMidpointToken$ - '$outlierVariableToken$')","| eval distance = if($thresholdDeviationToken$!=0, floor(distance/$thresholdDeviationToken$), 0)","| chart count over distance | makecontinuous distance"];Searches.setSearch("outliersBarChartVizSearch",{autostart:!1,searchString:["| loadjob $outlierSearchToken$"].concat(sharedSearchArray),onStartCallback:function(){outliersDistributionVizPanel.showLoadingOverlay();var _getVizQuery7=getVizQuery(sharedSearchArray),_getVizQuery8=_slicedToArray(_getVizQuery7,2);vizQueryArray=_getVizQuery8[0],vizQuerySearch=_getVizQuery8[1],outliersDistributionVizPanel.setVizOption("xAxisLabel",methodDeviationLabels[self.controls.thresholdMethodControl.val()]),outliersDistributionVizPanel.setVizOption("areaStartPosition",-.5),outliersDistributionVizPanel.setVizOption("areaEndPosition",Forms.getToken("thresholdMultiplierToken")),DrilldownLinker.setSearchDrilldown(outliersDistributionVizPanel.title,vizQuerySearch,getVizOptions())},onFinallyCallback:function(){outliersDistributionVizPanel.hideLoadingOverlay()}})}(),function(){var vizQueryArray=[],vizQuerySearch=null;outliersSplitCountPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQueryArray),"_blank")}),outliersSplitCountPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("outliersBarChartVizSearchModal","Plot the outlier size distribution",vizQueryArray,getFullSearchQueryComments().concat(['get the outlier count for each combination of "split by" values']),searchInfo.timeRange)});var sharedSearchArray=['| stats sum(isOutlier) as "outlier count" $splitByFieldsQueryToken$','| sort -"outlier count"'];Searches.setSearch("outliersSplitCountSearch",{autostart:!1,searchString:["| loadjob $outlierSearchToken$"].concat(sharedSearchArray),onStartCallback:function(){var _getVizQuery9=getVizQuery(sharedSearchArray),_getVizQuery10=_slicedToArray(_getVizQuery9,2);vizQueryArray=_getVizQuery10[0],vizQuerySearch=_getVizQuery10[1],DrilldownLinker.setSearchDrilldown(outliersSplitCountPanel.title,vizQuerySearch)}})}(),setTimeout(updateForm,0),this},loadExperiment:function(runExperiment){var _this2=this;this.stopListening(this.controls.outlierVariableControl,"datachange"),this.stopListening(this.controls.splitByFieldsControl,"datachange datachange-zero");var searchInfo=this.getSearchInfo();this.assistantFormView.searchBarControl.setSearchInfo(searchInfo);var mainSearchStage=this.model.experiment.getMainSearchStageModel();if(null!=mainSearchStage){var outlierField=mainSearchStage.outlierFields.getFieldsArray()[0],thresholdMethod=mainSearchStage.get("thresholdMethod"),thresholdMultiplier=mainSearchStage.get("thresholdMultiplier"),useCurrentPoint=mainSearchStage.get("useCurrentPoint"),windowSize=mainSearchStage.get("windowSize"),isWindowed=null!=windowSize&&windowSize>0,splitByFields=mainSearchStage.splitByFields.getFieldsArray();this.listenToOnce(this.controls.outlierVariableControl,"datachange",_underscoreMltk2.default.partial(function(outlierVar){Forms.setChoiceViewValueIfValid(_this2.controls.outlierVariableControl,outlierVar)},outlierField)),this.controls.thresholdMethodControl.val(thresholdMethod),this.controls.thresholdMultiplierControl.val(thresholdMultiplier),this.controls.windowSizeControl.val(windowSize),this.controls.windowedAnalysisCheckboxControl.val(isWindowed),this.controls.currentPointCheckboxControl.val(useCurrentPoint),this.listenToOnce(this.controls.splitByFieldsControl,"datachange datachange-zero",_underscoreMltk2.default.partial(function(splitBy,runExp){Forms.setChoiceViewValueIfValid(_this2.controls.splitByFieldsControl,splitBy),0===Forms.getChoiceViewChoices(_this2.controls.splitByFieldsControl).length&&setTimeout(function(){Messages.setDropdownMessage(_this2.controls.splitByFieldsControl,"No fields available to split by.")},0),runExp&&_this2.model.state.trigger("submit")},splitByFields,runExperiment))}},setDefaultMainStage:function(){if(null==this.model.experiment.getMainSearchStageModel()){var mainSearchStage=new _OutlierDetection2.default({thresholdMethod:"stdev",thresholdMultiplier:2,useCurrentPoint:!0});this.model.experiment.addSearchStages(mainSearchStage)}},controlsTemplate:'\n        <div class="mlts-input">\n            <label>Field to analyze</label>\n            <div id="outlierVariableControl"></div>\n        </div>\n        <div class="mlts-input">\n            <label>Threshold method</label>\n            <div id="thresholdMethodControl"></div>\n        </div>\n        <div class="mlts-input">\n            <label>Threshold multiplier</label>\n            <div id="thresholdMultiplierControl"></div>\n        </div>\n        <div class="mlts-input" id="windowedAnalysisControlWrapper">\n            <div class="checkbox">\n                <label><div id="windowedAnalysisCheckboxControl"></div>Sliding window (# of values)</label>\n            </div>\n            <div class="mlts-input" id="windowSizeControl"></div>\n            <div class="checkbox">\n                <div id="currentPointCheckboxControl"></div>\n                <label>Include current point</label>\n            </div>\n        </div>\n        <div class="mlts-input">\n            <label>Fields to split by</label>\n            <div id="splitByFieldsControl"></div>\n        </div>\n    ',template:'\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="outliersPanel"></div>\n            </div>\n        </div>\n\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="outliersOverTimePanel"></div>\n            </div>\n        </div>\n\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="outliersBarChartPanel"></div>\n            </div>\n        </div>\n\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="outliersTablePanel"></div>\n            </div>\n        </div>\n\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="outliersSplitCountPanel"></div>\n            </div>\n        </div>\n    '});new OutlierDetectionView}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},672:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[exports,__webpack_require__("util/time")],__WEBPACK_AMD_DEFINE_RESULT__=function(exports,_time){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function checkDataForTimestamps(dataRows,timeIndex){var hasTimestamps=!1;if(null!=dataRows&&dataRows.length>0){var firstPoint=dataRows[0][timeIndex],lastPoint=dataRows.length>1?dataRows[dataRows.length-1][timeIndex]:null,firstPointHasTimestamp=null!=firstPoint&&!isNaN(_time2.default.isoToDateObject(firstPoint).valueOf()),lastPointHasTimestamp=null!=lastPoint&&!isNaN(_time2.default.isoToDateObject(lastPoint).valueOf());hasTimestamps=firstPointHasTimestamp&&lastPointHasTimestamp&&firstPoint!==lastPoint}return hasTimestamps}Object.defineProperty(exports,"__esModule",{value:!0}),exports.checkDataForTimestamps=checkDataForTimestamps;var _time2=_interopRequireDefault(_time)}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}});