webpackJsonp([9],{0:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__webpack_require__.p=function(){function make_url(){for(var seg,len,output="",i=0,l=arguments.length;i<l;i++)seg=arguments[i].toString(),len=seg.length,len>1&&"/"==seg.charAt(len-1)&&(seg=seg.substring(0,len-1)),output+="/"!=seg.charAt(0)?"/"+seg:seg;if("/"!=output){var segments=output.split("/"),firstseg=segments[1];if("static"==firstseg||"modules"==firstseg){var postfix=output.substring(firstseg.length+2,output.length);output="/"+firstseg+"/@"+window.$C.BUILD_NUMBER,window.$C.BUILD_PUSH_NUMBER&&(output+="."+window.$C.BUILD_PUSH_NUMBER),"app"==segments[2]&&(output+=":"+getConfigValue("APP_BUILD",0)),output+="/"+postfix}}var root=getConfigValue("MRSPARKLE_ROOT_PATH","/"),djangoRoot=getConfigValue("DJANGO_ROOT_PATH",""),locale=getConfigValue("LOCALE","en-US"),combinedPath="";return combinedPath=djangoRoot&&output.substring(0,djangoRoot.length)===djangoRoot?output.replace(djangoRoot,djangoRoot+"/"+locale.toLowerCase()):"/"+locale+output,""==root||"/"==root?combinedPath:root+combinedPath}function getConfigValue(key,defaultValue){if(window.$C&&window.$C.hasOwnProperty(key))return window.$C[key];if(void 0!==defaultValue)return defaultValue;throw new Error("getConfigValue - "+key+" not set, no default provided")}return make_url("/static/app/Splunk_ML_Toolkit/")+"/"}(),__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),__webpack_require__("splunkjs/mvc/checkboxview"),__webpack_require__("splunkjs/mvc/dropdownview"),__webpack_require__("splunkjs/mvc/simpleform/input/submit"),__webpack_require__(200),__webpack_require__("splunkjs/mvc/textinputview"),__webpack_require__("splunkjs/mvc/utils"),__webpack_require__("splunkjs/mvc/visualizationregistry"),__webpack_require__(223),__webpack_require__(202),__webpack_require__(201),__webpack_require__(205),__webpack_require__(207),__webpack_require__(208),__webpack_require__(209),__webpack_require__(237),__webpack_require__(203),__webpack_require__(212),__webpack_require__(44),__webpack_require__(213),__webpack_require__(241),__webpack_require__(214),__webpack_require__(216),__webpack_require__(242),__webpack_require__(218),__webpack_require__(206),__webpack_require__(211),__webpack_require__(220)],__WEBPACK_AMD_DEFINE_RESULT__=function(_jquery,_underscore,_checkboxview,_dropdownview,_submit,_tableview,_textinputview,_utils,_visualizationregistry,_AssistantControlsFooter,_Footer,_Master,_DrilldownLinker,_Messages,_Modal,_QueryHistoryTable,_SearchStringDisplay,_Spinners,_compactTemplateString,_Options,_ShowcaseHistorySerializer,_ControlValidityStore,_NumberValidator,_AlertModal,_Master3,_EnhancedMultiDropdownView,_Forms,_Searches,_BaseAssistantView){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _taggedTemplateLiteral(strings,raw){return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}var _jquery2=_interopRequireDefault(_jquery),_underscore2=_interopRequireDefault(_underscore),_checkboxview2=_interopRequireDefault(_checkboxview),_dropdownview2=_interopRequireDefault(_dropdownview),_submit2=_interopRequireDefault(_submit),_tableview2=_interopRequireDefault(_tableview),_textinputview2=_interopRequireDefault(_textinputview),_utils2=_interopRequireDefault(_utils),_visualizationregistry2=_interopRequireDefault(_visualizationregistry),_AssistantControlsFooter2=_interopRequireDefault(_AssistantControlsFooter),_Master2=(_interopRequireDefault(_Footer),_interopRequireDefault(_Master)),DrilldownLinker=_interopRequireWildcard(_DrilldownLinker),Messages=_interopRequireWildcard(_Messages),_Modal2=_interopRequireDefault(_Modal),_QueryHistoryTable2=_interopRequireDefault(_QueryHistoryTable),_compactTemplateString2=(_interopRequireWildcard(_Spinners),_interopRequireDefault(_compactTemplateString)),_Options2=_interopRequireDefault(_Options),_ShowcaseHistorySerializer2=_interopRequireDefault(_ShowcaseHistorySerializer),_ControlValidityStore2=_interopRequireDefault(_ControlValidityStore),NumberValidator=_interopRequireWildcard(_NumberValidator),_AlertModal2=_interopRequireDefault(_AlertModal),_Master4=_interopRequireDefault(_Master3),_EnhancedMultiDropdownView2=_interopRequireDefault(_EnhancedMultiDropdownView),Forms=_interopRequireWildcard(_Forms),Searches=_interopRequireWildcard(_Searches),_BaseAssistantView2=_interopRequireDefault(_BaseAssistantView),_templateObject=_taggedTemplateLiteral(["| stats count by cluster | where count "," ","\n                                                    "," count "," ",""],["| stats count by cluster | where count "," ","\n                                                    "," count "," ",""]),_templateObject2=_taggedTemplateLiteral(['| loadjob $searchBarSearchJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column\n                               | search column != "column" AND column != "_*"'],['| loadjob $searchBarSearchJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column\n                               | search column != "column" AND column != "_*"']),_templateObject3=_taggedTemplateLiteral(["| loadjob $fullSearchJobIdToken$\n                               | table cluster\n                               | dedup cluster"],["| loadjob $fullSearchJobIdToken$\n                               | table cluster\n                               | dedup cluster"]),_templateObject4=_taggedTemplateLiteral(["| loadjob $preprocessedJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column $columnSearchToken$"],["| loadjob $preprocessedJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column $columnSearchToken$"]),_templateObject5=_taggedTemplateLiteral(['| loadjob $preprocessedJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column\n                               | search column != "column" AND column != "_*"'],['| loadjob $preprocessedJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column\n                               | search column != "column" AND column != "_*"']),_templateObject6=_taggedTemplateLiteral(["| inputlookup ",'_lookup\n                               | eval "Search query"=search_query,"Fields to preprocess"=preprocessed_variable,\n                               "Apply StandardScaler"=if(apply_ss==1, "yes", "no"), "Dimensionality Reduction"=if(apply_dr==1, \'dr_method\' + ": reduce to " + dr_num + " fields" , "n/a"),\n                                "Fields to use for clustering"=cluster_variable, "Clustering Algorithm"=algorithm, "Algorithm Parameters"=algorithm_params, "Model Name"=cluster_model_name, "Actions"=actions'],["| inputlookup ",'_lookup\n                               | eval "Search query"=search_query,"Fields to preprocess"=preprocessed_variable,\n                               "Apply StandardScaler"=if(apply_ss==1, "yes", "no"), "Dimensionality Reduction"=if(apply_dr==1, \'dr_method\' + ": reduce to " + dr_num + " fields" , "n/a"),\n                                "Fields to use for clustering"=cluster_variable, "Clustering Algorithm"=algorithm, "Algorithm Parameters"=algorithm_params, "Model Name"=cluster_model_name, "Actions"=actions']),ClusteringView=_BaseAssistantView2["default"].extend({headerOptions:{title:"Cluster Numeric Events",description:"Partition events with multiple numeric fields into clusters."},tabOptions:{primaryTabTitle:"Cluster Numeric Events",historyTabTitle:"Load Existing Settings"},showScheduleButton:!0,submitButtonText:"Cluster",searchBarTooltip:"The events returned should contain at least two numeric fields.",render:function(){function loadSavedPreprocessedSearch(sampleSearch){self.assistantFormView.tabs.activate("primaryTab"),currentSampleSearch=_underscore2["default"].extend({},{algorithm:"KMeans",algorithmParams:["k=2"]},sampleSearch),self.assistantFormView.searchBarControl.setProperties(sampleSearch.value,sampleSearch.earliestTime,sampleSearch.latestTime),preprocessCheckboxControl.val(currentSampleSearch.SSCheckbox||currentSampleSearch.DRCheckbox);var algorithm=currentSampleSearch.algorithm;algorithmControl.val(algorithm);var parsedParams=parseAlgorithmParams(currentSampleSearch.algorithmParams);"DBSCAN"===algorithm?epsControl.val(parsedParams.eps):"SpectralClustering"!==algorithm&&"KMeans"!==algorithm&&"Birch"!==algorithm||centroidsControl.val(parsedParams.k),null!=currentSampleSearch.modelName&&modelNameInputControl.val(currentSampleSearch.modelName)}function setupSearchBarSearch(){var searchBarSearch=Searches.getSearchManager("searchBarSearch");searchBarSearch.on("onStartCallback",function(){preprocessedResultsPanel.hide(),self.hideErrorMessage(),self.hideResults()}),searchBarSearch.on("onDoneCallback",function(searchManager){Searches.startSearch("variableSearch"),Searches.startSearch("preprocessSearch")}),searchBarSearch.on("onErrorCallback",function(errorMessage){self.showErrorMessage(errorMessage),preprocessedResultsPanel.hide(),self.hideResults()})}function setupPreprocessedSearch(){preprocessSubmitControlsFooter.controls.openInSearchButton.on("click",function(){if(preprocessValidationCheck(),preprocessControlValidity.getAll()){setPreprocessTokens();var fullSearchAndCommentsArray=getFullSearchAndCommentsArray([self.model.searchInfo.get("baseSearchString")],[null]),search=DrilldownLinker.createSearch(fullSearchAndCommentsArray.fullSearchQueryArray,self.model.searchInfo.get("baseTimerange"));window.open(DrilldownLinker.getUrl("search",search),"_blank")}}),preprocessSubmitControlsFooter.controls.showSPLButton.on("click",function(){if(preprocessValidationCheck(),preprocessControlValidity.getAll()){setPreprocessTokens();var fullSearchAndCommentsArray=getFullSearchAndCommentsArray([self.model.searchInfo.get("baseSearchString")],[null]);(0,_SearchStringDisplay.showSearchStringModal)("preprocessTrainingSearchStringDisplayModal","Fit a preprocess model on all your data in search",fullSearchAndCommentsArray.fullSearchQueryArray,fullSearchAndCommentsArray.fullSearchCommentsArray,self.model.searchInfo.get("baseTimerange"))}}),Searches.setSearch("preprocessSearch",{autostart:!1,searchString:"| loadjob $searchBarSearchJobIdToken$ $fitSSModelToken$ $fitDRModelToken$",targetJobIdTokenName:"preprocessedJobIdToken",onStartCallback:function(){isPreprocessSet()&&(updatePreprocessForm(!0),clusteringPanel.title.html("Preprocess Visualization"),clusteringPanel.title.tooltip("destroy"),clusteringPanel.title.tooltip({title:"Preview of the data prior to clustering.",container:clusteringPanel.title.closest(".mlts-cell")})),self.hideErrorMessage(),self.hideResults()},onDoneCallback:function(searchManager){var searchId=searchManager.getSid();if(Forms.setToken("searchEndJobIdToken",searchId),Searches.startSearch("clusterVariableSearch"),isPreprocessSet()&&(null==currentSampleSearch||null!=currentSampleSearch&&null==currentSampleSearch.clusterVariable)){preprocessedResultsPanel.show(),DrilldownLinker.setSearchDrilldown(preprocessedResultsPanel.title,self.model.searchInfo.get("baseSearchString")+Forms.getToken("fitSSModelToken")+Forms.getToken("fitDRModelToken")),clusteringPanel.openInSearchButton.off("click"),clusteringPanel.openInSearchButton.on("click",function(){var fullSearchandCommentsArray=getFullSearchAndCommentsArray([self.model.searchInfo.get("baseSearchString"),Forms.getToken("visualizeVariableToken")]);window.open(DrilldownLinker.getUrl("search",fullSearchandCommentsArray.fullSearchQueryArray.join(""),vizOptions),"_blank")}),clusteringPanel.showSPLButton.off("click"),clusteringPanel.showSPLButton.on("click",function(){var fullSearchandCommentsArray=getFullSearchAndCommentsArray([self.model.searchInfo.get("baseSearchString"),Forms.getToken("visualizeVariableToken")],[null,"display the selected variables"]);(0,_SearchStringDisplay.showSearchStringModal)("preprocessSearchStringDisplayModal","Display the preprocess in search",fullSearchandCommentsArray.fullSearchQueryArray,fullSearchandCommentsArray.fullSearchCommentsArray,self.model.searchInfo.get("baseTimerange"),vizOptions)}),clusteringPanel.setSchedulingDisabled(!0,"Preprocess doesn't support scheduled alerts.");var variableToVisualize=[];if(""!==Forms.getToken("fitDRModelToken"))for(var dimensionCount=parseInt(DRNumberControl.val(),10),i=1;i<=dimensionCount;i++)variableToVisualize.push("PC_"+i);else variableToVisualize=preprocessedVariableControl.val().map(function(variable){return"SS_"+variable});self.showResults(),visualizeVariableControl.val(variableToVisualize),visualizeSubmitControl.trigger("submit")}},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults(),preprocessedResultsPanel.hide()},onFinallyCallback:function(){updatePreprocessForm(!1)}})}function getFullSearchAndCommentsArray(initialSearchArray){var initialCommentsArray=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],fullSearchQueryArray=[].concat(initialSearchArray),fullCommentsArray=[].concat(initialCommentsArray);return""!==Forms.getToken("fitDRModelToken")&&(fullSearchQueryArray.splice(1,0,Forms.getToken("fitDRModelToken")),fullCommentsArray.splice(1,0,"apply a dimensionality reduction algorithm to extract features")),""!==Forms.getToken("fitSSModelToken")&&(fullSearchQueryArray.splice(1,0,Forms.getToken("fitSSModelToken")),fullCommentsArray.splice(1,0,"apply StandardScaler to standardize variables")),{fullSearchQueryArray:fullSearchQueryArray,fullSearchCommentsArray:fullCommentsArray}}function setupFullSearch(){self.assistantFormView.footer.controls.openInSearchButton.on("click",function(){if(clusterValidationCheck(),clusterControlValidity.getAll()){setClusterTokens();var fullSearchAndComments=getFullSearchAndCommentsArray([self.model.searchInfo.get("baseSearchString"),Forms.getToken("fitClusteringToken")]),search=DrilldownLinker.createSearch(fullSearchAndComments.fullSearchQueryArray,self.model.searchInfo.get("baseTimerange"));window.open(DrilldownLinker.getUrl("search",search),"_blank")}}),self.assistantFormView.footer.controls.showSPLButton.on("click",function(){if(clusterValidationCheck(),clusterControlValidity.getAll()){setClusterTokens();var initialCommentsArray=[null,"cluster the selected variables and save into a model"];isModelNameDisabled&&(initialCommentsArray[1]="cluster the selected variables");var fullSearchAndComments=getFullSearchAndCommentsArray([self.model.searchInfo.get("baseSearchString"),Forms.getToken("fitClusteringToken")],initialCommentsArray);(0,_SearchStringDisplay.showSearchStringModal)("clusterTrainingSearchStringDisplayModal","Fit a clustering model on all your data in search",fullSearchAndComments.fullSearchQueryArray,fullSearchAndComments.fullSearchCommentsArray,self.model.searchInfo.get("baseTimerange"))}}),self.assistantFormView.footer.controls.scheduleButton.on("click",function(){if(clusterValidationCheck(),clusterControlValidity.getAll()){setClusterTokens();var scheduledSearchModal=new _Master4["default"]({searchString:Forms.parseTemplate(self.model.searchInfo.get("baseSearchString")+"$fitSSModelToken$ $fitDRModelToken$ $fitClusteringToken$"),earliestTIme:self.model.searchInfo.get("baseTimerange").earliest_time,latestTime:self.model.searchInfo.get("baseTimerange").latest_time});scheduledSearchModal.render().appendTo((0,_jquery2["default"])("body")).show()}});var searchString="| loadjob $searchBarSearchJobIdToken$ $fitSSModelToken$ $fitDRModelToken$ $fitClusteringToken$";Searches.setSearch("fullSearch",{autostart:!1,targetJobIdTokenName:"fullSearchJobIdToken",searchString:searchString,onStartCallback:function(){preprocessedResultsPanel.hide(),self.hideResults(),self.hideErrorMessage(),updateForm(!0),clusteringPanel.title.html("Cluster Visualization"),clusteringPanel.title.tooltip("destroy"),clusteringPanel.title.tooltip({title:"The events, colored by cluster.",container:clusteringPanel.title.closest(".mlts-cell")})},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults(),preprocessedResultsPanel.hide()},onDoneCallback:function(searchManager){var searchId=searchManager.getSid();Forms.setToken("searchEndJobIdToken",searchId);var jobId=Searches.getSid(searchManager),searchAttributes=Searches.getSearchManager("searchBarSearch").search.attributes,algorithmParams=Forms.getToken("algorithmParamsToken");Array.isArray(algorithmParams)||(algorithmParams=[algorithmParams]);var collection={_time:parseInt((new Date).valueOf()/1e3,10),search_query:searchAttributes.search,earliest_time:searchAttributes.earliest_time,latest_time:searchAttributes.latest_time,apply_ss:""!==Forms.getToken("fitSSModelToken"),preprocessed_variable:isPreprocessSet()&&preprocessedVariableControl.val()||"",apply_dr:""!==Forms.getToken("fitDRModelToken"),dr_method:DRAlgorithmControl.val(),dr_num:parseInt(DRNumberControl.val()),algorithm:algorithmControl.val(),cluster_variable:clusterVariableControl.val(),algorithm_params:algorithmParams,cluster_model_name:Forms.getToken("modelNameToken")};historySerializer.persist(jobId,collection),clusteringPanel.openInSearchButton.off("click"),clusteringPanel.openInSearchButton.on("click",function(){var initialSearchQueryArray=[self.model.searchInfo.get("baseSearchString"),Forms.getToken("fitClusteringToken"),Forms.getToken("visualizeVariableToken")],fullSearchAndComments=getFullSearchAndCommentsArray(initialSearchQueryArray);window.open(DrilldownLinker.getUrl("search",fullSearchAndComments.fullSearchQueryArray.join(""),vizOptions),"_blank")}),clusteringPanel.showSPLButton.off("click"),clusteringPanel.showSPLButton.on("click",function(){var initialSearchQueryArray=[self.model.searchInfo.get("baseSearchString"),Forms.getToken("fitClusteringToken"),Forms.getToken("visualizeVariableToken")],initialSearchCommentsArray=[null,"cluster the selected variables and save into a model","display the selected variables"];isModelNameDisabled&&(initialSearchCommentsArray[1]="cluster the selected variables");var fullSearchAndComments=getFullSearchAndCommentsArray(initialSearchQueryArray,initialSearchCommentsArray);(0,_SearchStringDisplay.showSearchStringModal)("clusteringSearchStringDisplayModal","Display the cluster in search",fullSearchAndComments.fullSearchQueryArray,fullSearchAndComments.fullSearchCommentsArray,self.model.searchInfo.get("baseTimerange"),vizOptions)}),isModelNameDisabled?clusteringPanel.setSchedulingDisabled(isModelNameDisabled,"This algorithm doesn’t support scheduled alerts."):Forms.getToken("modelNameToken")===defaultModelName?clusteringPanel.setSchedulingDisabled(!0,"You must specify a model name to schedule alerts."):clusteringPanel.setSchedulingDisabled(!1),clusteringPanel.scheduleAlertButton.off("click"),clusteringPanel.scheduleAlertButton.on("click",function(){if(null==clusteringAlertModal){clusteringAlertModal=new _Modal2["default"]("clusteringAlertModal",{title:"Schedule an alert",destroyOnHide:!1,type:"wide"});var clusterSelectionControl=new _dropdownview2["default"]({id:"clusterSelectionControl",el:(0,_jquery2["default"])("<span>"),selectFirstChoice:!0,managerid:"clusterListingSearch",labelField:"cluster",valueField:"cluster",showClearButton:!1}).render(),valueRangeDropdownControl=new _dropdownview2["default"]({id:"valueRangeDropdownControl",el:(0,_jquery2["default"])("<span>"),showClearButton:!1,choices:[{label:"greater than",value:">"},{label:"less than",value:"<"},{label:"between",value:"> AND <"},{label:"not between",value:"< OR >"}]}).render(),firstValueControl=new _textinputview2["default"]({id:"firstValueControl",el:(0,_jquery2["default"])("<span>")}).render(),secondValueControl=new _textinputview2["default"]({id:"secondValueControl",el:(0,_jquery2["default"])("<span>")}).render();valueRangeDropdownControl.on("change",function(value){">"===value||"<"===value?firstValueControl.$el.nextAll().hide():firstValueControl.$el.nextAll().show()}),clusteringAlertModal.body.addClass("mlts-modal-form-inline").append((0,_jquery2["default"])("<p>").text("Alert me when the number of events in cluster"),clusterSelectionControl.$el,(0,_jquery2["default"])("<p>").text(" is "),valueRangeDropdownControl.$el,firstValueControl.$el,(0,_jquery2["default"])("<p>").text("and"),secondValueControl.$el);var cancelButton=(0,_jquery2["default"])("<button>").addClass("mlts-modal-cancel").attr({type:"button","data-dismiss":"modal"}).addClass("btn btn-default mlts-modal-cancel").text("Cancel"),_submitButtonText="Next",submitButton=(0,_jquery2["default"])("<button>").attr({type:"button"}).addClass("btn btn-primary mlts-modal-submit").text(_submitButtonText);clusteringAlertModal.footer.append(cancelButton,submitButton.on("click",function(){clusteringAlertModal.removeAlert();var valueRange=valueRangeDropdownControl.val(),clusterName=clusterSelectionControl.val(),searchString='| where cluster=="'+clusterName+'" ',triggerCustomSearch="",validationOptions={allowFloats:!1},firstValue=firstValueControl.val(),isValid=NumberValidator.validate(firstValue,validationOptions);if(Messages.setFormInputStatus(firstValueControl,isValid),">"===valueRange||"<"===valueRange)triggerCustomSearch="| stats count by cluster | where count "+valueRange+" "+firstValue;else if("> AND <"===valueRange||"< OR >"===valueRange){var secondValue=secondValueControl.val(),secondValueValid=NumberValidator.validate(secondValue,validationOptions);Messages.setFormInputStatus(secondValueControl,secondValueValid),isValid=isValid&&secondValueValid,valueRange=valueRange.split(" "),triggerCustomSearch=(0,_compactTemplateString2["default"])(_templateObject,valueRange[0],Math.min(firstValue,secondValue),valueRange[1],valueRange[2],Math.max(firstValue,secondValue))}if(searchString.length>0)if(isValid){var alertQueryArray=[self.model.searchInfo.get("baseSearchString"),Forms.getToken("applySSModelToken"),Forms.getToken("applyDRModelToken"),"| apply "+Forms.getToken("modelNameToken"),searchString];searchString=alertQueryArray.join(" "),submitButton.attr("disabled",!0).text("Loading...");new _AlertModal2["default"]({searchString:searchString}).done(function(alertModal){clusteringAlertModal.isShown()?(clusteringAlertModal.hide(),alertModal.model.alert.entry.content.set("ui.scheduled.triggercondition","custom"),alertModal.model.alert.entry.content.set("ui.scheduled.customsearch",triggerCustomSearch),alertModal.render().appendTo((0,_jquery2["default"])("body")).show()):alertModal.remove()}).fail(function(message){clusteringAlertModal.setAlert(message),submitButton.attr("disabled",!1).text(_submitButtonText)})}else clusteringAlertModal.setAlert("Alert threshold must be a integer.")})),clusteringAlertModal.$el.on("show.bs.modal",function(){submitButton.attr("disabled",!1).text(_submitButtonText),clusteringAlertModal.removeAlert(),Messages.setFormInputStatus([firstValueControl,secondValueControl],!0),valueRangeDropdownControl.val(">"),firstValueControl.val(0),secondValueControl.val(0)})}clusteringAlertModal.show()}),self.showResults(),visualizeVariableControl.val(clusterVariableControl.val()),visualizeSubmitControl.trigger("submit")},onFinallyCallback:function(){updateForm(!1)}})}function setupVariableSearch(){Searches.setSearch("variableSearch",{searchString:(0,_compactTemplateString2["default"])(_templateObject2),onStartCallback:function(){self.hideErrorMessage()},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()}})}function setupClusterListingSearch(){Searches.setSearch("clusterListingSearch",{searchString:(0,_compactTemplateString2["default"])(_templateObject3),onStartCallback:function(){self.hideErrorMessage()},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()}})}function setupClusterVariableSearch(){Searches.setSearch("clusterVariableSearch",{autostart:!1,searchString:(0,_compactTemplateString2["default"])(_templateObject4),onStartCallback:function(){hidePreprocessErrorMessage()},onDoneCallback:function(){Searches.startSearch("visualizeVariableSearch")},onErrorCallback:function(errorMessage){showPreprocessErrorMessage(errorMessage,preprocessErrorDisplay$El),self.hideResults()}})}function setupVisualizeVariableSearch(){Searches.setSearch("visualizeVariableSearch",{autostart:!1,searchString:(0,_compactTemplateString2["default"])(_templateObject5),onStartCallback:function(){hidePreprocessErrorMessage()},onErrorCallback:function(errorMessage){showPreprocessErrorMessage(errorMessage,preprocessErrorDisplay$El)}})}function setupVisualizeSearch(){Searches.setSearch("visualizeSearch",{autostart:!1,searchString:"| loadjob $searchEndJobIdToken$ $visualizeVariableToken$",onStartCallback:function(){self.hideErrorMessage(),preprocessedResultsPanel.hide()},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage)}})}function populatePreprocessedInputs(currentSampleSearch){SSCheckboxControl.val(currentSampleSearch.SSCheckbox),DRCheckboxControl.val(currentSampleSearch.DRCheckbox),DRAlgorithmControl.val(currentSampleSearch.DRAlgorithm),DRNumberControl.val(currentSampleSearch.DRNumber),preprocessSubmitControlsFooter.controls.submitButton.trigger("submit")}function setPreprocessTokens(){fitDRModelString="",fitSSModelString="";var DRAlgorithm=DRAlgorithmControl.val(),DRNumber=DRNumberControl.val(),variables='"'+preprocessedVariableControl.val().join('", "')+'"';SSCheckboxControl.val()&&(fitSSModelString="| fit StandardScaler "+variables+" "),DRCheckboxControl.val()?(fitDRModelString=SSCheckboxControl.val()?"| fit "+DRAlgorithm+" SS_* k="+DRNumber+" ":"| fit "+DRAlgorithm+" "+variables+" k="+DRNumber+" ",Forms.setToken("columnSearchToken",'| search column = "PC_*"')):SSCheckboxControl.val()&&Forms.setToken("columnSearchToken",'| search column = "SS_*"'),Forms.setToken("fitClusteringToken",""),Forms.setToken("fitSSModelToken",fitSSModelString),Forms.setToken("fitDRModelToken",fitDRModelString)}function setClusterTokens(){var clusterVariable='"'+clusterVariableControl.val().join('", "')+'"',modelNameValue=modelNameInputControl.val();Forms.setToken("modelNameToken",null==modelNameValue||0===modelNameValue.length?defaultModelName:modelNameValue),modelNameValue=Forms.getToken("modelNameToken");var saveModelNameSting="",algorithm=algorithmControl.val(),algorithmParam="";"DBSCAN"===algorithm?(algorithmParam="eps="+epsControl.val(),saveModelNameSting=""):"SpectralClustering"===algorithm?(algorithmParam="k="+centroidsControl.val(),saveModelNameSting=""):"KMeans"!==algorithm&&"Birch"!==algorithm||(algorithmParam="k="+centroidsControl.val(),saveModelNameSting='into "'+modelNameValue+'"',""!==Forms.getToken("fitSSModelToken")?(Forms.setToken("fitSSModelToken",fitSSModelString+'into "'+modelNameValue+'_SS" '),Forms.setToken("applySSModelToken",'| apply "'+modelNameValue+'_SS" ')):Forms.setToken("applySSModelToken",""),""!==Forms.getToken("fitDRModelToken")?(Forms.setToken("fitDRModelToken",fitDRModelString+'into "'+modelNameValue+"_"+DRAlgorithmControl.val()+'" '),Forms.setToken("applyDRModelToken",'| apply "'+modelNameValue+"_"+DRAlgorithmControl.val()+'" ')):Forms.setToken("applyDRModelToken","")),Forms.setToken("algorithmParamsToken",algorithmParam);var fitClusteringString="| fit "+algorithm+" "+clusterVariable+" "+algorithmParam+" ";fitClusteringString+=saveModelNameSting,Forms.setToken("fitClusteringToken",fitClusteringString)}function updatePreprocessForm(newIsRunningValue){null!=newIsRunningValue&&(isPreprocessRunning=newIsRunningValue),isPreprocessRunning?preprocessSubmitControlsFooter.setDisabled(isPreprocessRunning,"Preprocessing..."):preprocessSubmitControlsFooter.setDisabled(!preprocessCheckboxControl.val(),"Preprocess"),preprocessedVariableControl.settings.set("disabled",!preprocessCheckboxControl.val()||isPreprocessRunning),SSCheckboxControl.settings.set("disabled",!preprocessCheckboxControl.val()||isPreprocessRunning),DRCheckboxControl.settings.set("disabled",!preprocessCheckboxControl.val()||isPreprocessRunning),DRAlgorithmControl.settings.set("disabled",!preprocessCheckboxControl.val()||!DRCheckboxControl.val()||isPreprocessRunning),DRNumberControl.settings.set("disabled",!preprocessCheckboxControl.val()||!DRCheckboxControl.val()||isPreprocessRunning),preprocessCheckboxControl.settings.set("disabled",isPreprocessRunning)}function updateForm(newIsRunningValue){null!=newIsRunningValue&&(isClusteringRunning=newIsRunningValue),isClusteringRunning?self.assistantFormView.footer.setDisabled(isClusteringRunning,"Clustering..."):self.assistantFormView.footer.setDisabled(!validateSubmitButton(),submitButtonText),algorithmControl.settings.set("disabled",isClusteringRunning),centroidsControl.settings.set("disabled",isClusteringRunning),epsControl.settings.set("disabled",isClusteringRunning),clusterVariableControl.settings.set("disabled",isClusteringRunning),visualizeVariableControl.settings.set("disabled",isClusteringRunning),isModelNameDisabled||self.$el.find("#modelNameInputControl").attr("disabled",isClusteringRunning)}function validateSubmitButton(){return clusterVariableControl.val().length>0}function validateModelNameForTraining(){null==modelNameInputControl||isModelNameDisabled||(null==modelNameInputControl.val()||0===modelNameInputControl.val().length?self.assistantFormView.footer.setSchedulingDisabled(!0,"You must specify a model name to fit a model on a schedule."):self.assistantFormView.footer.setSchedulingDisabled(!1))}function preprocessValidationCheck(){hidePreprocessErrorMessage(),Messages.setFormInputStatus(DRNumberControl,!0),Messages.setFormInputStatus(preprocessedVariableControl,!0),preprocessControlValidity.clearAll(),preprocessedVariableControl.val().length>0&&(DRCheckboxControl.val()||SSCheckboxControl.val())?DRCheckboxControl.val()&&preprocessedVariableControl.val().length>0&&preprocessedVariableControl.val().length<parseInt(DRNumberControl.val(),10)&&(Messages.setFormInputStatus(DRNumberControl,!1),preprocessControlValidity.set(DRNumberControl.id,!1),showPreprocessErrorMessage("dimensionality reduction number should be no more than fields to process")):(preprocessedVariableControl.val().length<=0&&(Messages.setFormInputStatus(preprocessedVariableControl,!1),preprocessControlValidity.set(preprocessedVariableControl.id,!1),showPreprocessErrorMessage("You must select at least one value.",preprocessErrorDisplay$El)),DRCheckboxControl.val()||SSCheckboxControl.val()||(preprocessControlValidity.set("preprocessAlgorithmExist",!1),showPreprocessErrorMessage("You must select at least one preprocess method.",preprocessErrorDisplay$El)))}function clusterValidationCheck(){Messages.removeTextInputMessage(centroidsControl),Messages.removeTextInputMessage(epsControl),clusterControlValidity.clearAll();var algorithm=algorithmControl.val();"SpectralClustering"===algorithm||"KMeans"===algorithm||"Birch"===algorithm?NumberValidator.validate(centroidsControl.val(),{min:1,allowFloats:!1})||(clusterControlValidity.set(centroidsControl.id,!1),Messages.setTextInputMessage(centroidsControl,"Value must be a positive integer.")):"DBSCAN"===algorithm&&(NumberValidator.validate(epsControl.val(),{min:0,minExclusive:!0})||(clusterControlValidity.set(epsControl.id,!1),Messages.setTextInputMessage(epsControl,"Value must be a positive number.")))}function showPreprocessErrorMessage(errorMessage){var errorDisplay$El=self.$el.find("#preprocessErrorDisplay");
Messages.setAlert(errorDisplay$El,errorMessage,void 0,void 0,!0)}function hidePreprocessErrorMessage(){var errorDisplay$El=self.$el.find("#preprocessErrorDisplay");Messages.removeAlert(errorDisplay$El,!0)}function isPreprocessSet(){return""!==Forms.getToken("fitDRModelToken")||""!==Forms.getToken("fitSSModelToken")}function isClusteringSet(){return""!==Forms.getToken("fitClusteringToken")}function parseAlgorithmParams(algorParams){var paramsArray=Array.isArray(algorParams)?algorParams:[algorParams],result={};return paramsArray.forEach(function(paramStr){var equalIndex=paramStr.indexOf("=");if(equalIndex>=0){var attr=paramStr.substring(0,equalIndex);result[attr]=paramStr.substring(equalIndex+1)}}),result}var self=this;_BaseAssistantView2["default"].prototype.render.call(this);var _utils$getPageInfo=_utils2["default"].getPageInfo(),appName=_utils$getPageInfo.app,showcaseName=_utils$getPageInfo.page,historyCollectionId=showcaseName+"_history",defaultModelName=_Options2["default"].getOptionByName("defaultModelName"),submitButtonText="Cluster",preprocessErrorDisplay$El=self.$el.find("#preprocessErrorDisplay"),clusteringPanel$El=self.$el.find("#clusteringPanel"),vizOptions=DrilldownLinker.parseVizOptions({category:"custom",type:appName+".ScatterplotMatrixViz"}),sampleSearchFirstRun=!1,preprocessControlValidity=new _ControlValidityStore2["default"],clusterControlValidity=new _ControlValidityStore2["default"],currentSampleSearch=null,clusteringAlertModal=null,isPreprocessRunning=!1,isClusteringRunning=!1,fitSSModelString="",fitDRModelString="",isModelNameDisabled=!1,historySerializer=new _ShowcaseHistorySerializer2["default"](historyCollectionId,{_time:null,search_query:null,earliest_time:null,latest_time:null,apply_ss:null,preprocessed_variable:null,apply_dr:null,dr_method:null,dr_num:null,algorithm:null,algorithm_params:null,cluster_variable:null,cluster_model_name:null},function(){Searches.startSearch("queryHistorySearch")}),clusteringPanel=function(){var ClusteringViz=_visualizationregistry2["default"].getVisualizer(appName,"ScatterplotMatrixViz"),assistantPanel=new _Master2["default"]({el:clusteringPanel$El,title:"Clustering Visualization",viz:ClusteringViz,tooltip:"The events, colored by cluster.",vizOptions:{id:"clusteringViz",managerid:"visualizeSearch"},footerButtons:{scheduleAlertButton:!0}});return assistantPanel.viz.$el.on("hasNonNumericDataEvent",function(){preprocessedResultsPanel.show(),DrilldownLinker.setSearchDrilldown(preprocessedResultsPanel.title,self.model.searchInfo.get("baseSearchString"))}),assistantPanel.fieldsWrapper=(0,_jquery2["default"])("<div>").addClass("mlts-visualize-picker"),assistantPanel.fieldsWrapper.insertAfter(assistantPanel.header).append((0,_jquery2["default"])("<div>").attr("id","visualizeVariableControl"),(0,_jquery2["default"])("<div>").attr("id","visualizeSubmitControl")),assistantPanel.visualizeVariableControl=visualizeVariableControl,assistantPanel.visualizeSubmitControl=visualizeSubmitControl,assistantPanel}();!function(){Searches.setSearch("queryHistorySearch",{searchString:(0,_compactTemplateString2["default"])(_templateObject6,showcaseName)})}(),this.assistantFormView.searchBarControl.events.on("change",function(){Forms.clearChoiceView(clusterVariableControl,!1),Forms.clearChoiceView(preprocessedVariableControl,!0),Forms.clearChoiceView(visualizeVariableControl,!1),Forms.unsetToken("visualizeVariableToken"),Forms.unsetToken("fitClusteringToken"),hidePreprocessErrorMessage(),Messages.setFormInputStatus(DRNumberControl,!0),Messages.setFormInputStatus(preprocessedVariableControl,!0),Forms.setToken("fitDRModelToken",""),Forms.setToken("fitSSModelToken",""),Forms.setToken("columnSearchToken",'| search column != "column" AND column != "_*"'),updateForm(),updatePreprocessForm(),Searches.cancelSearch("fullSearch"),Searches.cancelSearch("preprocessSearch"),sampleSearchFirstRun||(currentSampleSearch=null),sampleSearchFirstRun&&(sampleSearchFirstRun=!1),Searches.startSearch("searchBarSearch")});var preprocessedResultsPanel=new _Master2["default"]({el:this.$el.find("#preprocessedResultsTable"),title:"Preprocessed Results Preview",viz:_tableview2["default"],vizOptions:{managerid:"preprocessSearch"},footerButtons:!1}),preprocessedVariableControl=function(){var preprocessedVariableControl=new _EnhancedMultiDropdownView2["default"]({id:"preprocessedVariableControl",managerid:"variableSearch",el:self.$el.find("#preprocessedVariableControl"),labelField:"column",valueField:"column",width:400});return preprocessedVariableControl.$el.prev("label").tooltip({title:"Select the fields to preprocess before clustering."}),preprocessedVariableControl.on("datachange",function(){if(null!=currentSampleSearch&&null!=currentSampleSearch.preprocessedVariable&&currentSampleSearch.preprocessedVariable.length>0){var choices=Forms.getChoiceViewChoices(preprocessedVariableControl),validChoices=Forms.intersect(choices,currentSampleSearch.preprocessedVariable,!0);validChoices.length===currentSampleSearch.preprocessedVariable.length&&(preprocessedVariableControl.val(validChoices),populatePreprocessedInputs(currentSampleSearch))}}),preprocessedVariableControl.on("change",function(values){Messages.setFormInputStatus(preprocessedVariableControl,!0)}),preprocessedVariableControl.render(),preprocessedVariableControl}(),algorithmControl=(new _QueryHistoryTable2["default"](self.$el.find("#queryHistoryPanel"),"queryHistorySearch",historyCollectionId,["Actions","_time","Search query","Fields to preprocess","Apply StandardScaler","Dimensionality Reduction","Clustering Algorithm","Fields to use for clustering","Algorithm Parameters","Model Name"],submitButtonText,function(params,autostart){var savedSearch={};savedSearch.value=params.data["row.search_query"],savedSearch.earliestTime=params.data["row.earliest_time"],savedSearch.latestTime=params.data["row.latest_time"],savedSearch.preprocessedVariable=params.data["row.preprocessed_variable"],savedSearch.SSCheckbox="0"!==params.data["row.apply_ss"],savedSearch.DRCheckbox="0"!==params.data["row.apply_dr"],savedSearch.DRAlgorithm=params.data["row.dr_method"],savedSearch.DRNumber=params.data["row.dr_num"],savedSearch.algorithm=params.data["row.algorithm"],savedSearch.clusterVariable=params.data["row.cluster_variable"],savedSearch.algorithmParams=Array.isArray(params.data["row.algorithm_params"])?params.data["row.algorithm_params"]:[params.data["row.algorithm_params"]],savedSearch.modelName=params.data["row.cluster_model_name"],savedSearch.autostart=autostart,loadSavedPreprocessedSearch(savedSearch),sampleSearchFirstRun=!0}),function(){var algorithmControl=new _dropdownview2["default"]({id:"algorithmControl",el:self.$el.find("#algorithmControl"),selectFirstChoice:!0,showClearButton:!1,choices:[{label:"K-means",value:"KMeans"},{label:"DBSCAN",value:"DBSCAN"},{label:"Birch",value:"Birch"},{label:"Spectral Clustering",value:"SpectralClustering"}]});return algorithmControl.$el.prev("label").tooltip({title:"Select the algorithm to use for clustering."}),algorithmControl.on("change",function(value){null!=centroidsControl&&null!=epsControl&&("KMeans"===value||"Birch"===value?(centroidsControl.$el.parent().css("display","inline-block"),epsControl.$el.parent().css("display","none"),isModelNameDisabled=!1):"DBSCAN"===value?(centroidsControl.$el.parent().css("display","none"),epsControl.$el.parent().css("display","inline-block"),isModelNameDisabled=!0):"SpectralClustering"===value&&(centroidsControl.$el.parent().css("display","inline-block"),epsControl.$el.parent().css("display","none"),isModelNameDisabled=!0),isModelNameDisabled?self.assistantFormView.footer.setSchedulingDisabled(!0,"This algorithm doesn’t support scheduled model fitting."):validateModelNameForTraining(),self.$el.find("#modelNameInputControl > input").attr("disabled",isModelNameDisabled),isModelNameDisabled?self.$el.find("#modelNameInputControl").tooltip({title:"This algorithm doesn't save models."}):self.$el.find("#modelNameInputControl").tooltip("destroy"))}),algorithmControl.render(),algorithmControl}()),centroidsControl=function(){var centroidsControl=new _textinputview2["default"]({id:"centroidsControl",initialValue:2,el:self.$el.find("#centroidsControl")});return centroidsControl.$el.prev("label").tooltip({title:"Specify the number of clusters."}),algorithmControl&&"DBSCAN"===algorithmControl.val()&&self.$el.find("#centroidsControlWrapper").css("display","none"),centroidsControl.render(),centroidsControl}(),epsControl=function(){var epsControl=new _textinputview2["default"]({id:"epsControl",initialValue:.2,el:self.$el.find("#epsControl")});return epsControl.$el.prev("label").tooltip({title:"Specify the size of the neighborhood, between 0 and 1. Smaller values will result in more clusters."}),algorithmControl&&"DBSCAN"!==algorithmControl.val()&&epsControl.$el.parent().css("display","none"),epsControl.render(),epsControl}(),clusterVariableControl=function(){var clusterVariableControl=new _EnhancedMultiDropdownView2["default"]({id:"clusterVariableControl",managerid:"clusterVariableSearch",el:self.$el.find("#clusterVariableControl"),labelField:"column",valueField:"column",width:400});return clusterVariableControl.$el.prev("label").tooltip({title:"Events will be clustered based on the values of these fields."}),clusterVariableControl.on("datachange",function(){if(null!=currentSampleSearch&&null!=currentSampleSearch.clusterVariable&&currentSampleSearch.clusterVariable.length>0){var choices=Forms.getChoiceViewChoices(clusterVariableControl),validChoices=Forms.intersect(choices,currentSampleSearch.clusterVariable,!0);validChoices.length===currentSampleSearch.clusterVariable.length&&(clusterVariableControl.val(validChoices),currentSampleSearch.autostart!==!1?self.assistantFormView.footer.controls.submitButton.trigger("submit"):currentSampleSearch=null)}}),clusterVariableControl.on("change",function(){validateSubmitButton()?(self.assistantFormView.footer.setDisabled(!1),validateModelNameForTraining()):self.assistantFormView.footer.setDisabled(!0)}),clusterVariableControl.render(),clusterVariableControl}(),visualizeVariableControl=function(){var visualizeVariableControl=new _EnhancedMultiDropdownView2["default"]({id:"visualizeVariableControl",managerid:"visualizeVariableSearch",el:self.$el.find("#visualizeVariableControl"),labelField:"column",valueField:"column",width:960});return visualizeVariableControl.on("datachange",function(){isPreprocessSet()&&visualizeVariableControl.val(Forms.getChoiceViewChoices(clusterVariableControl))}),visualizeVariableControl.on("change",function(values){visualizeSubmitControl.settings.set("formReady",values.length>0)}),visualizeVariableControl.render(),visualizeVariableControl}(),preprocessCheckboxControl=function(){var preprocessCheckboxControl=new _checkboxview2["default"]({id:"preprocessCheckboxControl",el:self.$el.find("#preprocessCheckboxControl"),"default":!1});return preprocessCheckboxControl.on("change",function(value){value||(Forms.clearChoiceView(clusterVariableControl,!0),Forms.clearChoiceView(visualizeVariableControl,!0),hidePreprocessErrorMessage(),Messages.setFormInputStatus(DRNumberControl,!0),Messages.setFormInputStatus(preprocessedVariableControl,!0),Forms.setToken("fitSSModelToken",""),Forms.setToken("fitDRModelToken",""),Forms.setToken("columnSearchToken",'| search column != "column" AND column != "_*"'),Searches.cancelSearch("fullSearch"),Searches.startSearch("preprocessSearch")),updatePreprocessForm()}),preprocessCheckboxControl.render(),preprocessCheckboxControl}(),SSCheckboxControl=function(){var SSCheckboxControl=new _checkboxview2["default"]({id:"SSCheckboxControl",el:self.$el.find("#SSCheckboxControl"),"default":!1});return SSCheckboxControl.$el.parent().prev("label").tooltip({html:!0,title:'<div style="text-align: left">\n                <ul>\n                  <li>StandardScaler: Standardize the field values to have a mean of zero and a standard deviation of one (recommended). Standardized fields will be prefixed with "SS_".</li>\n                  <li>PCA/KernelPCA: Reduce the dimensionality of the data (recommended if it takes a long time to cluster the events). This projection will create fields prefixed with "PC_".</li>\n                </ul>\n                </div>'}),Forms.setToken("fitSSModelToken",""),SSCheckboxControl.render(),SSCheckboxControl}(),DRCheckboxControl=function(){var DRCheckboxControl=new _checkboxview2["default"]({id:"DRCheckboxControl",el:self.$el.find("#DRCheckboxControl"),"default":!1});return DRCheckboxControl.on("change",function(applyDR){applyDR?(DRAlgorithmControl.settings.set("disabled",!1),DRNumberControl.settings.set("disabled",!1)):(Messages.setFormInputStatus(DRNumberControl,!0),DRAlgorithmControl.settings.set("disabled",!0),DRNumberControl.settings.set("disabled",!0))}),Forms.setToken("fitDRModelToken",""),DRCheckboxControl.settings.set("disabled",!0),DRCheckboxControl.render(),DRCheckboxControl}(),DRAlgorithmControl=function(){var DRAlgorithmControl=new _dropdownview2["default"]({id:"DRAlgorithmControl",el:self.$el.find("#DRAlgorithmControl"),selectFirstChoice:!0,showClearButton:!1,choices:[{label:"PCA",value:"PCA"},{label:"KernelPCA",value:"KernelPCA"}]});return DRAlgorithmControl.settings.set("disabled",!0),DRAlgorithmControl.render(),DRAlgorithmControl}(),DRNumberControl=function(){var DRNumberControl=new _dropdownview2["default"]({id:"DRNumberControl",el:self.$el.find("#DRNumberControl"),selectFirstChoice:!0,showClearButton:!1,choices:[{label:"2",value:"2"},{label:"3",value:"3"},{label:"4",value:"4"},{label:"5",value:"5"}]});return DRNumberControl.on("change",function(){Messages.setFormInputStatus(DRNumberControl,!0)}),DRNumberControl.settings.set("disabled",!0),DRNumberControl.render(),DRNumberControl}(),modelNameInputControl=function(){var modelNameInputControl=new _textinputview2["default"]({id:"modelNameInputControl",el:self.$el.find("#modelNameInputControl")}).render();modelNameInputControl.$el.prev("label").tooltip({title:'Enter a name for the learned cluster model. Preprocessing models will be saved with this as a prefix and "_ss" (StandardScaler) or "_pc" (PCA or KernelPCA) as a suffix.'}),modelNameInputControl.on("change",function(){validateModelNameForTraining()}),modelNameInputControl.trigger("change");var modelNameInputControl$El=modelNameInputControl.$el.children('input[type="text"]');return modelNameInputControl$El.attr("placeholder","(optional)"),modelNameInputControl$El.on("keyup",function(event){modelNameInputControl.val(modelNameInputControl$El.val()),13===event.keyCode&&self.assistantFormView.footer.controls.submitButton.trigger("submit")}),modelNameInputControl}(),preprocessSubmitControlsFooter=function(){var preprocessSubmitControlsFooter=new _AssistantControlsFooter2["default"](self.$el.find("#preprocessSubmitControlsFooter"),"Preprocess",(!1));return preprocessSubmitControlsFooter.controls.submitButton.attr("id","preprocessSubmitControl"),preprocessSubmitControlsFooter.controls.submitButton.on("submit",function(){preprocessValidationCheck(),preprocessControlValidity.getAll()&&(Forms.clearChoiceView(clusterVariableControl,!0),Forms.clearChoiceView(visualizeVariableControl,!0),setPreprocessTokens(),Searches.startSearch("preprocessSearch"))}),preprocessSubmitControlsFooter}();this.assistantFormView.footer.controls.submitButton.on("submit",function(){currentSampleSearch=null,clusterValidationCheck(),clusterControlValidity.getAll()&&(setClusterTokens(),Searches.startSearch("fullSearch"))});var visualizeSubmitControl=function(){var visualizeSubmitControl=new _submit2["default"]({id:"visualizeSubmitControl",el:self.$el.find("#visualizeSubmitControl"),text:"Visualize"});return visualizeSubmitControl.on("submit",function(){var visualizeVariableString='"'+visualizeVariableControl.val().join('", "')+'"',renamedSeriesString=isClusteringSet()?'"Cluster: " + cluster':'"Preprocessed Data" ';Forms.setToken("visualizeVariableToken","| eval cluster= "+renamedSeriesString+" | table cluster, "+visualizeVariableString+" ");var fullSearchQuery=self.model.searchInfo.get("baseSearchString")+Forms.getToken("fitSSModelToken")+Forms.getToken("fitDRModelToken")+Forms.getToken("fitClusteringToken")+Forms.getToken("visualizeVariableToken");DrilldownLinker.setSearchDrilldown(clusteringPanel.title,fullSearchQuery,vizOptions),Searches.startSearch("visualizeSearch")}),self.$el.find("#visualizeSubmitControl > button").removeClass("btn-primary").addClass("btn-deafult"),visualizeSubmitControl.settings.set("formReady",!1),visualizeSubmitControl.render(),visualizeSubmitControl}();return setupSearchBarSearch(),setupPreprocessedSearch(),setupVariableSearch(),setupClusterVariableSearch(),setupVisualizeVariableSearch(),setupFullSearch(),setupClusterListingSearch(),setupVisualizeSearch(),this.sampleSearchDeferred.done(function(searchParams){loadSavedPreprocessedSearch(searchParams),sampleSearchFirstRun=!0}),setTimeout(function(){updatePreprocessForm(),updateForm()},0),this},controlsTemplate:'\n        <div class="mlts-preprocess">\n            <label class="checkbox">\n                <div id="preprocessCheckboxControl"></div>\n                <h3>Preprocess (optional)</h3>\n            </label>\n            <div class="mlts-preprocessing-field">\n                <div class="mlts-input">\n                    <label>Fields to preprocess</label>\n                    <div id="preprocessedVariableControl"></div>\n                </div>\n\n                <div class="mlts-preprocessing-methods">\n                    <label>Select method(s) to use</label>\n                    <label class="checkbox">\n                        <div id="SSCheckboxControl"></div>Apply StandardScaler\n                    </label>\n                    <label class="checkbox">\n                        <div id="DRCheckboxControl"></div>Apply<div id="DRAlgorithmControl"></div>to reduce dimensionality to<div id="DRNumberControl"></div>fields\n                    </label>\n                </div>\n                <div id="preprocessErrorDisplay" class="alerts shared-flashmessages mlts-error-messages"></div>\n            </div>\n            <div id="preprocessSubmitControlsFooter"></div>\n        </div>\n        <div>\n            <h3>Cluster</h3>\n            <div class="mlts-input">\n                <label>Algorithm</label>\n                <div id="algorithmControl"></div>\n            </div>\n            <div class="mlts-input">\n                <label>Fields to use for clustering</label>\n                <div id="clusterVariableControl"></div>\n            </div>\n            <div id="centroidsControlWrapper" class="mlts-input">\n                <label>K (# of centroids)</label>\n                <div id="centroidsControl"></div>\n            </div>\n\n            <div id="epsControlWrapper" class="mlts-input">\n                <label>eps (radius of neighborhood) </label>\n                <div id="epsControl"></div>\n            </div>\n            <div class="mlts-input">\n                <label>Save the model as</label>\n                <div id="modelNameInputControl"></div>\n            </div>\n        </div>\n     ',template:'\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="preprocessedResultsTable">\n                <h3></h3>\n                </div>\n            </div>\n        </div>\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="clusteringPanel"></div>\n            </div>\n        </div>\n    '}),clusteringView=new ClusteringView;clusteringView.deferreds.viewReady.done(function(layout){layout.getContainerElement().appendChild(clusteringView.render().el)})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},"splunkjs/mvc/simpleform/input/submit":function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_RESULT__=function(require){var _=__webpack_require__("require/underscore"),$=__webpack_require__("shim/jquery"),BaseSplunkView=__webpack_require__("splunkjs/mvc/basesplunkview"),Dashboard=__webpack_require__("splunkjs/mvc/simplexml/controller"),FormUtils=__webpack_require__("splunkjs/mvc/simpleform/formutils"),SubmitButton=BaseSplunkView.extend({className:"splunk-submit-button form-submit",options:{text:_("Submit").t(),useIcon:!1},events:{"click button":function(e){e.preventDefault(),this.$("button").is(".disabled")||this.trigger("submit",this)},"click .delete-input":function(e){e.preventDefault(),Dashboard.model.view.updateFormSettings({submitButton:!1}).done(_.bind(this.remove,this))}},initialize:function(){this.configure(),this.listenTo(this.settings,"change",this.render),this.listenTo(Dashboard.getStateModel(),"change:edit",this.onEditModeChange);var settings=this.settings;settings.set("formReady",FormUtils.isFormReady()),_.defer(function(){FormUtils.onFormReady().then(function(){settings.set("formReady",!0)})}),this.listenTo(settings,"change",this.render)},onEditModeChange:function(){if(this.$(".edit-dropdown").remove(),Dashboard.isEditMode()){var el=$('<div class="edit-dropdown"><a href="#" class="delete-input"><i class="icon-x"/></a></div>');el.find(".delete-input").attr("title",_("Delete submit button").t()),el.prependTo(this.el)}},render:function(){var button=this.$("button");return button.length||(button=$('<button class="btn btn-primary"></button>').appendTo(this.el)),this.settings.get("useIcon")?button.html('<i class="icon-search"></i>'):this.settings.has("text")?button.text(this.settings.get("text")):this.settings.set("text",button.text()),button[this.settings.get("formReady")?"removeClass":"addClass"]("disabled"),this.onEditModeChange(),this}});return SubmitButton}.call(exports,__webpack_require__,exports,module),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}});