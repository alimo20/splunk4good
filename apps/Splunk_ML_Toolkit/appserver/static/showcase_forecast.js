webpackJsonp([16],{0:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__webpack_require__.p=function(){function make_url(){for(var seg,len,output="",i=0,l=arguments.length;i<l;i++)seg=arguments[i].toString(),len=seg.length,len>1&&"/"==seg.charAt(len-1)&&(seg=seg.substring(0,len-1)),output+="/"!=seg.charAt(0)?"/"+seg:seg;if("/"!=output){var segments=output.split("/"),firstseg=segments[1];if("static"==firstseg||"modules"==firstseg){var postfix=output.substring(firstseg.length+2,output.length);output="/"+firstseg,window.$C.BUILD_NUMBER&&(output+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(output+="."+window.$C.BUILD_PUSH_NUMBER),"app"==segments[2]&&(output+=":"+getConfigValue("APP_BUILD",0)),output+="/"+postfix}}var root=getConfigValue("MRSPARKLE_ROOT_PATH","/"),djangoRoot=getConfigValue("DJANGO_ROOT_PATH",""),locale=getConfigValue("LOCALE","en-US"),combinedPath="";return combinedPath=djangoRoot&&output.substring(0,djangoRoot.length)===djangoRoot?output.replace(djangoRoot,djangoRoot+"/"+locale.toLowerCase()):"/"+locale+output,""==root||"/"==root?combinedPath:root+combinedPath}function getConfigValue(key,defaultValue){if(window.$C&&window.$C.hasOwnProperty(key))return window.$C[key];if(void 0!==defaultValue)return defaultValue;throw new Error("getConfigValue - "+key+" not set, no default provided")}return make_url("/static/app/Splunk_ML_Toolkit/")+"/"}(),__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__(513),__webpack_require__("splunkjs/mvc"),__webpack_require__("splunkjs/mvc/chartview"),__webpack_require__("splunkjs/mvc/dropdownview"),__webpack_require__("splunkjs/mvc/singleview"),__webpack_require__("splunkjs/mvc/utils"),__webpack_require__("splunkjs/mvc/visualizationregistry"),__webpack_require__(671),__webpack_require__(623),__webpack_require__(620),__webpack_require__(624),__webpack_require__(625),__webpack_require__(621),__webpack_require__(545),__webpack_require__(548),__webpack_require__(547),__webpack_require__(509),__webpack_require__(626),__webpack_require__(643),__webpack_require__(541),__webpack_require__(629),__webpack_require__(631)],__WEBPACK_AMD_DEFINE_RESULT__=function(_jquery,_underscoreMltk,_mvc,_chartview,_dropdownview,_singleview,_utils,_visualizationregistry,_ForecastParamsGroup,_Footer,_Master,_DrilldownLinker,_SearchStringDisplay,_Spinners,_Fit,_Predict,_compactTemplateString,_Options,_ColorPalette,_EnhancedTextInputView,_Forms,_Searches,_BaseAssistantView){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _taggedTemplateLiteral(strings,raw){return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}var _jquery2=_interopRequireDefault(_jquery),_underscoreMltk2=_interopRequireDefault(_underscoreMltk),_mvc2=_interopRequireDefault(_mvc),_chartview2=_interopRequireDefault(_chartview),_dropdownview2=_interopRequireDefault(_dropdownview),_singleview2=_interopRequireDefault(_singleview),_utils2=_interopRequireDefault(_utils),_ForecastParamsGroup2=_interopRequireDefault(_ForecastParamsGroup),_Footer2=_interopRequireDefault(_Footer),_Master2=_interopRequireDefault(_Master),DrilldownLinker=_interopRequireWildcard(_DrilldownLinker),Spinners=_interopRequireWildcard(_Spinners),_Fit2=_interopRequireDefault(_Fit),_Predict2=_interopRequireDefault(_Predict),_compactTemplateString2=_interopRequireDefault(_compactTemplateString),_Options2=_interopRequireDefault(_Options),_EnhancedTextInputView2=_interopRequireDefault(_EnhancedTextInputView),Forms=_interopRequireWildcard(_Forms),Searches=_interopRequireWildcard(_Searches),_BaseAssistantView2=_interopRequireDefault(_BaseAssistantView),_slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_templateObject=_taggedTemplateLiteral(["Withholding allows us to compare the forecast against known values (those that were withheld).\n                         This comparison is done using the R² and RMSE statistics and the Forecast Outliers, below."],["Withholding allows us to compare the forecast against known values (those that were withheld).\n                         This comparison is done using the R² and RMSE statistics and the Forecast Outliers, below."]),_templateObject2=_taggedTemplateLiteral(['| loadjob $searchBarSearchJobIdToken$\n                           | head 1\n                           | transpose\n                           | fields column\n                           | search column != "column" AND column != "_*"'],['| loadjob $searchBarSearchJobIdToken$\n                           | head 1\n                           | transpose\n                           | fields column\n                           | search column != "column" AND column != "_*"']),_templateObject3=_taggedTemplateLiteral(["| eval isOutlier = if(prediction!=\"\" AND '$predictFieldsToken$' != \"\"\n                                                    AND ('$predictFieldsToken$' < 'lower$confidenceIntervalToken$(prediction)'\n                                                    OR '$predictFieldsToken$' > 'upper$confidenceIntervalToken$(prediction)'), 1, 0)"],["| eval isOutlier = if(prediction!=\"\" AND '$predictFieldsToken$' != \"\"\n                                                    AND ('$predictFieldsToken$' < 'lower$confidenceIntervalToken$(prediction)'\n                                                    OR '$predictFieldsToken$' > 'upper$confidenceIntervalToken$(prediction)'), 1, 0)"]),ForecastView=_BaseAssistantView2.default.extend({headerOptions:{title:"Forecast Time Series",description:'Enter a search (should contain "_time" field with UNIX timestamp values)'},submitButtonText:"Forecast",searchBarTooltip:'The events returned should contain a "_time" field with UNIX timestamp values and at least one other numeric field.',historyStatisticsFields:["rSquared","RMSE","outlierCount"],activateSaveTooltip:"To activate Save, successfully create a forecast.",renderPanels:function(){function isUsingPredict(){return self.model.experiment.getMainSearchStageModel().get("type")===_Predict2.default.TYPE}function getForecastSearchString(){return(isUsingPredict()?predictForecastSearchString:fitForecastSearchString)+" "+forecastVizString}function getVizQuery(){var sharedSearchArray=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[getForecastSearchString()],searchInfo=self.getSearchInfo(),vizQueryArray=[searchInfo.searchString].concat(sharedSearchArray),vizQuerySearch=DrilldownLinker.createSearch(vizQueryArray,searchInfo.timeRange);return[vizQueryArray,vizQuerySearch]}function submitForm(){!self.model.state.get("footerDisabled")&&self.controlValidity.getAll()&&(Searches.startSearch(searchManagerId),submitted=!0)}function updateForm(newIsRunningValue){if(null!=newIsRunningValue&&(isRunning=newIsRunningValue),self.controls.forecastAlgorithmControl.settings.set("disabled",isRunning),self.controls.predictFieldsControl.settings.set("disabled",isRunning),self.controls.forecastAlgorithmParamsControls.setDisabled(isRunning),isRunning)self.model.state.set({footerDisabled:isRunning,submitButtonText:"Forecasting..."}),submitted&&self.model.state.trigger("submitStarted");else{var predictFieldsToken=Forms.getToken("predictFieldsToken"),fieldsValid=null!=predictFieldsToken&&predictFieldsToken.length>0;self.model.state.set({footerDisabled:!fieldsValid,submitButtonText:self.submitButtonText}),fieldsValid&&submitted&&(submitSuccess&&(self.model.experimentSubmitPristine.setFromSplunkD(self.model.experiment.toSplunkD()),self.model.state.trigger("submitSuccess"),submitSuccess=!1),submitted=!1)}}function updateForecastAlgorithmParamsToken(){var mainSearchStage=self.model.experiment.getMainSearchStageModel(),paramsCollectionId=isUsingPredict()?"params":"algorithmParams";mainSearchStage[paramsCollectionId].resetParams(self.controls.forecastAlgorithmParamsControls.serialize(!0));var futureTimespan=self.controls.forecastAlgorithmParamsControls.controls.future_timespan.control.val(),holdback=self.controls.forecastAlgorithmParamsControls.controls.holdback.control.val();Forms.setTokens({forecastAlgorithmParamsToken:self.controls.forecastAlgorithmParamsControls.serialize().join(" "),futurePointsToken:futureTimespan+holdback,holdbackToken:holdback,confidenceIntervalToken:self.controls.forecastAlgorithmParamsControls.controls.conf_interval.control.val()})}function toggleARIMAPanels(showPanels){showPanels?(acfSeriesPanel.show(),pacfSeriesPanel.show(),acfResidualPanel.show(),pacfResidualPanel.show()):(acfSeriesPanel.hide(),pacfSeriesPanel.hide(),acfResidualPanel.hide(),pacfResidualPanel.hide())}var _this=this,self=this;_BaseAssistantView2.default.prototype.renderPanels.call(this);var _utils$getPageInfo=_utils2.default.getPageInfo(),appName=_utils$getPageInfo.app,searchManagerId="forecastSearch",smallLoaderScale=_Options2.default.getOptionByName("smallLoaderScale"),defaultVizHeight=_Options2.default.getOptionByName("defaultVizHeight"),predictForecastSearchString="| predict $predictFieldsToken|s$ as prediction $forecastAlgorithmParamsToken$",fitForecastSearchString="| fit $forecastAlgorithmToken$ _time $predictFieldsToken$ $forecastAlgorithmParamsToken$ as prediction",forecastVizString="| `forecastviz($futurePointsToken$, $holdbackToken$, $predictFieldsToken|s$, $confidenceIntervalToken$)`",modvizpredictExplain="forecast using a macro that formats the command output for forecast chart visualization",isRunning=!1,submitted=!1,submitSuccess=!1;this.forecastAlgorithmSettings={predict:{params:["algorithm","future_timespan","holdback","conf_interval","period"]},ARIMA:{params:["autoregressive","integrated","moving_average","future_timespan","holdback","conf_interval"]}},this.controls.forecastAlgorithmParamsControls=new _ForecastParamsGroup2.default(self.$el.find("#forecastAlgorithmParamsControlsWrapper")),function(){self.controls.forecastAlgorithmParamsControls.addControl("algorithm",new _dropdownview2.default({id:"methodControl",el:(0,_jquery2.default)("<div>"),default:"LLP",labelField:"label",valueField:"value",showClearButton:!1,choices:[{label:"LLP5 (combines LLT and LLP)",value:"LLP5"},{label:"LL (local level)",value:"LL"},{label:"LLP (seasonal local level)",value:"LLP"},{label:"LLT (local level trend)",value:"LLT"}]}).render(),"Method","Select the appropriate method, which will depend on whether your data has long-term trends, periodicity, or both."),self.controls.forecastAlgorithmParamsControls.addControl("holdback",new _EnhancedTextInputView2.default({id:"holdbackControl",el:(0,_jquery2.default)("<div>"),default:0,validator:{type:"number",message:"Value must be a positive integer or zero.",allowFloats:!1,min:0}}).render(),"Holdback",(0,_compactTemplateString2.default)(_templateObject)),self.controls.forecastAlgorithmParamsControls.addControl("future_timespan",new _EnhancedTextInputView2.default({id:"futureTimespanControl",default:5,validator:{type:"number",message:"Value must be a positive integer or zero.",allowFloats:!1,min:0}}).render(),"Future Timespan","The further into the future the forecast, the less accurate it is likely to be."),self.controls.forecastAlgorithmParamsControls.addControl("conf_interval",new _EnhancedTextInputView2.default({id:"confidenceIntervalControl",default:95,el:(0,_jquery2.default)("<div>"),validator:{type:"number",message:"Value must be an integer between 0 and 99.",allowFloats:!1,min:0,max:99}}).render(),"Confidence Interval","Specify an integer between 0 and 99, where a larger value means a greater tolerance for forecast uncertainty."),self.controls.forecastAlgorithmParamsControls.addControl("period",new _EnhancedTextInputView2.default({id:"periodControl",el:(0,_jquery2.default)("<div>"),default:"",optional:!0,validator:{type:"number",message:"Value must be a positive integer.",allowFloats:!1,min:1}}).render(),"Period","If the data has a known periodicity, specify it here. The units of the period are equal to span of the _time field. For example, hourly data may have a period of 24 (one day), whereas daily data may have a period of 7 (one week)."),self.controls.forecastAlgorithmParamsControls.addControl("autoregressive",new _EnhancedTextInputView2.default({id:"autoregressiveControl",el:(0,_jquery2.default)("<div>"),default:0,validator:{type:"number",message:"Value must be a positive integer or zero.",allowFloats:!1,min:0}}).render(),"AR (autoregressive) - p","The autoregressive order - the number of time lags used in the autoregressive part of the model."),self.controls.forecastAlgorithmParamsControls.addControl("integrated",new _EnhancedTextInputView2.default({id:"integratedControl",el:(0,_jquery2.default)("<div>"),default:0,validator:{type:"number",message:"Value must be 0, 1, or 2.",allowFloats:!1,min:0,max:2}}).render(),"I (integrated) - d","The integrated order or degree of differences - the number of times the data have had past values subtracted."),self.controls.forecastAlgorithmParamsControls.addControl("moving_average",new _EnhancedTextInputView2.default({id:"movingAverageControl",el:(0,_jquery2.default)("<div>"),default:0,validator:{type:"number",message:"Value must be a positive integer or zero.",allowFloats:!1,min:0}}).render(),"MA (moving average) - q","The moving average order - the number of data points to use in the moving average part of the model."),_underscoreMltk2.default.each(self.controls.forecastAlgorithmParamsControls.controls,function(controlAttributes,id){self.listenTo(controlAttributes.control,"change",function(value,control){null!=control.options.validator&&self.controlValidity.set(control.id,control.getValidity()),updateForecastAlgorithmParamsToken()})})}(),this.controls.forecastAlgorithmControl=function(){var control=new _dropdownview2.default({id:"forecastAlgorithmControl",el:self.$el.find("#forecastAlgorithmControl"),showClearButton:!1,choices:[{label:"Kalman Filter",value:"predict"},{label:"ARIMA",value:"ARIMA"}]});return control.$el.prev("label").tooltip({title:"Select the algorithm to use for forecasting."}),control.on("change",function(){var algorithm=this.val();self.controlValidity.clearAll();var mainSeachStage=self.model.experiment.getMainSearchStageModel();null!=mainSeachStage&&self.model.experiment.removeSearchStages(mainSeachStage),self.setDefaultMainStage(algorithm),Forms.setToken("forecastAlgorithmToken",algorithm),self.controls.predictFieldsControl.trigger("change"),self.controls.forecastAlgorithmParamsControls.activate(self.forecastAlgorithmSettings[algorithm].params,!1,algorithm),Searches.setSearchString(searchManagerId,"| loadjob $searchBarSearchJobIdToken$ "+getForecastSearchString()),updateForecastAlgorithmParamsToken(),updateForm()}),control.render(),control}(),this.controls.predictFieldsControl=function(){var control=new _dropdownview2.default({id:"predictFieldsControl",el:_this.$el.find("#predictFieldsControl"),managerid:"predictionFieldsSearch",labelField:"column",valueField:"column",showClearButton:!1});return control.$el.prev("label").tooltip({title:"Select the numeric field to forecast."}),control.on("change",function(){var fields=this.val()||[],fieldsCollectionId=isUsingPredict()?"fields":"featureVariables";self.model.experiment.getMainSearchStageModel()[fieldsCollectionId].resetFields(_underscoreMltk2.default.asArray(fields)),Forms[fields.length>0?"setToken":"unsetToken"]("predictFieldsToken",fields),updateForm()}),control.render(),control}();var regressionStatisticsPanel=function(){var footer=new _Footer2.default(_this.$el.find("#regressionStatisticsPanel"));return footer.spinnerAnchor=footer.footer.parent(".mlts-panel"),footer}(),r2StatisticPanel=function(){return new _Master2.default({el:_this.$el.find("#r2StatisticPanel"),title:"R<sup>2</sup> Statistic",tooltip:{html:!0,title:"The square of the correlation coefficient between the forecasted and actual values. Better forecasts have an R<sup>2</sup> closer to 1."},viz:_singleview2.default,vizOptions:{id:"r2StatisticViz",managerid:"regressionstatisticsSearch",field:"rSquared",numberPrecision:"0.0000",height:30},footerButtons:!1})}(),rootMeanSquaredErrorStatisticPanel=function(){return new _Master2.default({el:_this.$el.find("#rootMeanSquaredErrorStatisticPanel"),title:"Root Mean Squared Error (RMSE)",tooltip:"The quadratic mean of the prediction errors (residuals). Better models have a smaller RMSE.",viz:_singleview2.default,vizOptions:{id:"rootMeanSquaredErrorStatisticViz",managerid:"regressionstatisticsSearch",field:"RMSE",numberPrecision:"0.00",height:30},footerButtons:!1})}(),predictionOutliersStatisticPanel=function(){var assistantPanel=new _Master2.default({el:_this.$el.find("#predictionOutliersStatisticPanel"),title:"Forecast Outliers",tooltip:"Number of values in the test period that fall outside the confidence interval.",viz:_singleview2.default,vizOptions:{id:"predictionOutliersStatisticViz",managerid:"predictionOutliersSearch",field:"count",numberPrecision:"0",height:30}});return assistantPanel.plotOutliersOverTimeButton=(0,_jquery2.default)("<button>").addClass("btn btn-default mlts-plot-outliers-over-time").text("Plot Outliers Over Time"),assistantPanel.footer.append(assistantPanel.plotOutliersOverTimeButton),assistantPanel}(),forecastPanel=function(){var ForecastViz=(0,_visualizationregistry.getVisualizer)(appName,"ForecastViz");return new _Master2.default({el:_this.$el.find("#forecastPanel"),title:"Forecast",tooltip:'The input data, forecast, and confidence intervals. Values to the right of the "training-test split" line were not shown to the algorithm. Narrower confidence intervals mean more confident predictions.',viz:ForecastViz,vizOptions:{id:"forecastViz",height:defaultVizHeight,managerid:searchManagerId}})}(),hexBlue=(0,_ColorPalette.getColorByIndex)(0,!1,!0),hexRed=(0,_ColorPalette.getColorByIndex)(2,!1,!0),hexYellow=(0,_ColorPalette.getColorByIndex)(38,!1,!0),colorArrayString=_mvc2.default.tokenSafe("["+hexRed+", "+hexBlue+", "+hexRed+"]"),residualColorArrayString=_mvc2.default.tokenSafe("["+hexYellow+", "+hexBlue+", "+hexYellow+"]"),commonAutoCorrelationOptions={"charting.chart.columnSpacing":"20","charting.lineDashStyle":"shortDash","charting.legend.placement":"bottom",height:defaultVizHeight},lowerTokenStart="lower$confidenceIntervalACFToken$",upperTokenStart="upper$confidenceIntervalACFToken$",acfSeriesPanel=function(){var lowerField=lowerTokenStart+"(acf($predictFieldsToken$))",upperField=upperTokenStart+"(acf($predictFieldsToken$))",assistantPanel=new _Master2.default({el:self.$el.find("#acfSeriesPanel"),title:"ACF Chart",tooltip:"The autocorrelation function (ACF) chart shows how correlated points are with each other, based on how many lags they are separated by.",viz:_chartview2.default,vizOptions:_underscoreMltk2.default.extend(commonAutoCorrelationOptions,{id:"acfSeriesViz",managerid:"acfSeriesPlotSearch","charting.chart.overlayFields":_mvc2.default.tokenSafe(lowerField+","+upperField),"charting.chart.seriesColors":colorArrayString})});return assistantPanel}(),pacfSeriesPanel=function(){var lowerField=lowerTokenStart+"(pacf($predictFieldsToken$))",upperField=upperTokenStart+"(pacf($predictFieldsToken$))",assistantPanel=new _Master2.default({el:self.$el.find("#pacfSeriesPanel"),title:"PACF Chart",tooltip:"The partial autocorrelation function (PACF) chart shows how correlated points are with each other, based on how many lags they are separated by, while controlling for the correlation caused by earlier lags.",viz:_chartview2.default,vizOptions:_underscoreMltk2.default.extend(commonAutoCorrelationOptions,{id:"pacfSeriesViz",managerid:"pacfSeriesPlotSearch","charting.chart.overlayFields":_mvc2.default.tokenSafe(lowerField+","+upperField),"charting.chart.seriesColors":colorArrayString})});return assistantPanel}(),acfResidualPanel=function(){var lowerField=lowerTokenStart+"(acf(residual))",upperField=upperTokenStart+"(acf(residual))",assistantPanel=new _Master2.default({el:self.$el.find("#acfResidualPanel"),title:"ACF Residual Chart",tooltip:"The residual autocorrelation function (ACF) chart shows how correlated residuals (errors) are with each other, based on how many lags they are separated by.",viz:_chartview2.default,vizOptions:_underscoreMltk2.default.extend(commonAutoCorrelationOptions,{id:"acfResidualViz",managerid:"acfResidualPlotSearch","charting.chart.overlayFields":_mvc2.default.tokenSafe(lowerField+","+upperField),"charting.chart.seriesColors":residualColorArrayString})});return assistantPanel}(),pacfResidualPanel=function(){var lowerField=lowerTokenStart+"(pacf(residual))",upperField=upperTokenStart+"(pacf(residual))",assistantPanel=new _Master2.default({el:self.$el.find("#pacfResidualPanel"),title:"PACF Residual Chart",tooltip:"The residual partial autocorrelation function (PACF) chart shows how correlated residuals (errors) are with each other, based on how many lags they are separated by, while controlling for the correlation caused by earlier lags.",viz:_chartview2.default,vizOptions:_underscoreMltk2.default.extend(commonAutoCorrelationOptions,{id:"pacfResidualViz",managerid:"pacfResidualPlotSearch","charting.chart.overlayFields":_mvc2.default.tokenSafe(lowerField+","+upperField),"charting.chart.seriesColors":residualColorArrayString})});return assistantPanel}();return this.assistantFormView.searchBarControl.events.on("change",function(){Forms.clearChoiceView(self.controls.predictFieldsControl,!0),updateForm()}),this.listenTo(this.model.state,"submit",function(){submitForm()}),function(){var searchBarSearch=Searches.getSearchManager("searchBarSearch");searchBarSearch.on("onStartCallback",function(){self.hideErrorMessage(),self.hideResults()}),searchBarSearch.on("onErrorCallback",function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()})}(),function(){Searches.setSearch("predictionFieldsSearch",{searchString:(0,_compactTemplateString2.default)(_templateObject2),onStartCallback:function(){self.hideErrorMessage()},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()}})}(),function(){function openInSearch(){var _getVizQuery=getVizQuery(),_getVizQuery2=_slicedToArray(_getVizQuery,2);vizQueryArray=_getVizQuery2[0],vizQuerySearch=_getVizQuery2[1],window.open(DrilldownLinker.getUrl("search",vizQuerySearch,vizOptions),"_blank")}function showSPL(e){var modalTitle=forecastPanel.showSPLButton.first().is((0,_jquery2.default)(e.target))?"Plot forecast":"Calculate the forecast",_getVizQuery3=getVizQuery(),_getVizQuery4=_slicedToArray(_getVizQuery3,2);vizQueryArray=_getVizQuery4[0],vizQuerySearch=_getVizQuery4[1];var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)(searchManagerId+"Modal",modalTitle,vizQueryArray,[null,[modvizpredictExplain]],searchInfo.timeRange,vizOptions)}var vizQueryArray=[],vizQuerySearch=null,vizOptions=DrilldownLinker.parseVizOptions({category:"custom",type:appName+".ForecastViz"});self.listenTo(self.model.state,"openInSearch",openInSearch),self.listenTo(self.model.state,"showSPL",showSPL),forecastPanel.openInSearchButton.on("click",openInSearch),forecastPanel.showSPLButton.on("click",showSPL),Searches.setSearch(searchManagerId,{autostart:!1,targetJobIdTokenName:"predictJobIdToken",searchString:"| loadjob $searchBarSearchJobIdToken$ "+getForecastSearchString(),onStartCallback:function(){Spinners.showLoadingOverlay([forecastPanel.viz.$el,acfResidualPanel.viz.$el,pacfResidualPanel.viz.$el]),self.hideErrorMessage(),updateForm(!0);var _getVizQuery5=getVizQuery(),_getVizQuery6=_slicedToArray(_getVizQuery5,2);vizQueryArray=_getVizQuery6[0],vizQuerySearch=_getVizQuery6[1],DrilldownLinker.setSearchDrilldown(forecastPanel.title,vizQuerySearch,vizOptions);var showARIMAPanels=!isUsingPredict();showARIMAPanels&&(Searches.startSearch("acfSeriesPlotSearch"),Searches.startSearch("pacfSeriesPlotSearch")),toggleARIMAPanels(showARIMAPanels)},onDoneCallback:function(){self.accumulateExperimentHistory(Searches.getSid(this)),Forms.setToken("confidenceIntervalACFToken",Forms.getToken("confidenceIntervalToken")),self.showResults(),Searches.startSearch("predictionOutliersSearch"),Searches.startSearch("regressionstatisticsSearch");var showARIMAPanels=!isUsingPredict();showARIMAPanels?(Searches.startSearch("acfResidualPlotSearch"),Searches.startSearch("pacfResidualPlotSearch")):toggleARIMAPanels(!1),submitSuccess=!0},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()},onFinallyCallback:function(){updateForm(!1),Spinners.hideLoadingOverlay(forecastPanel.viz.$el)}})}(),function(){var identifyOutliersSearchQueryArray=[(0,_compactTemplateString2.default)(_templateObject3)],findOutliersSearchQueryArray=identifyOutliersSearchQueryArray.concat(["| where isOutlier=1","| fields - isOutlier"]),outlierExplain="find the outliers among events that have both an actual and a predicted value",vizQueryArray=[],vizQuerySearch=null,outliersOverTimeVizOptions=DrilldownLinker.parseVizOptions({category:"custom",type:appName+".LinesViz"});predictionOutliersStatisticPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}),predictionOutliersStatisticPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("predictionOutliersSearchStringDisplayModal","Show forecast outliers",vizQueryArray,[null,modvizpredictExplain,outlierExplain],searchInfo.timeRange)}),predictionOutliersStatisticPanel.plotOutliersOverTimeButton.on("click",function(){var searchInfo=self.getSearchInfo(),_getVizQuery7=getVizQuery([getForecastSearchString()].concat(identifyOutliersSearchQueryArray)),_getVizQuery8=_slicedToArray(_getVizQuery7,2);vizQueryArray=_getVizQuery8[0],vizQuerySearch=_getVizQuery8[1];var outliersOverTimeSearch=DrilldownLinker.createSearch(vizQueryArray.concat(["| table _time, isOutlier"]),searchInfo.timeRange);window.open(DrilldownLinker.getUrl("search",outliersOverTimeSearch,outliersOverTimeVizOptions),"_blank")}),Searches.setSearch("predictionOutliersSearch",{autostart:!1,searchString:["| loadjob $predictJobIdToken$"].concat(findOutliersSearchQueryArray,["| stats count as outlierCount"]),onStartCallback:function(){Spinners.showLoadingOverlay(predictionOutliersStatisticPanel.viz.$el,smallLoaderScale);var _getVizQuery9=getVizQuery([getForecastSearchString()].concat(findOutliersSearchQueryArray)),_getVizQuery10=_slicedToArray(_getVizQuery9,2);vizQueryArray=_getVizQuery10[0],vizQuerySearch=_getVizQuery10[1],DrilldownLinker.setSearchDrilldown(predictionOutliersStatisticPanel.title,vizQuerySearch)},onDataCallback:function(data){self.accumulateExperimentStatistics(Searches.getSid(searchManagerId),data)},onFinallyCallback:function(){Spinners.hideLoadingOverlay(predictionOutliersStatisticPanel.viz.$el)}})}(),function(){var regressionstatisticsSearchQueryArray=['| where prediction!="" AND \'$predictFieldsToken$\' != ""',"| `regressionstatistics($predictFieldsToken|s$, prediction)`"],vizQueryArray=[],vizQuerySearch=null;regressionStatisticsPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}),regressionStatisticsPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("regressionstatisticsSearchStringDisplayModal","Compute R² and root mean squared error (RMSE)",vizQueryArray,[null,modvizpredictExplain,null,"use the `regressionstatistics` macro to compute R² and RMSE"],searchInfo.timeRange)}),Searches.setSearch("regressionstatisticsSearch",{autostart:!1,searchString:["| loadjob $predictJobIdToken$"].concat(regressionstatisticsSearchQueryArray),onStartCallback:function(){Spinners.showLoadingOverlay(regressionStatisticsPanel.spinnerAnchor,smallLoaderScale);var _getVizQuery11=getVizQuery([getForecastSearchString()].concat(regressionstatisticsSearchQueryArray)),_getVizQuery12=_slicedToArray(_getVizQuery11,2);vizQueryArray=_getVizQuery12[0],vizQuerySearch=_getVizQuery12[1],DrilldownLinker.setSearchDrilldown(r2StatisticPanel.title,vizQuerySearch),DrilldownLinker.setSearchDrilldown(rootMeanSquaredErrorStatisticPanel.title,vizQuerySearch)},onDataCallback:function(data){self.accumulateExperimentStatistics(Searches.getSid(searchManagerId),data)},onFinallyCallback:function(){Spinners.hideLoadingOverlay(regressionStatisticsPanel.spinnerAnchor)}})}(),function(){var sharedSearchArray=["| fit ACF $predictFieldsToken|s$ conf_interval=$confidenceIntervalToken$",'| table Lag "lower$confidenceIntervalToken$(acf($predictFieldsToken$))" "acf($predictFieldsToken$)" "upper$confidenceIntervalToken$(acf($predictFieldsToken$))"'],vizQueryArray=[],vizQuerySearch=null;acfSeriesPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}),acfSeriesPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("acfSearchStringDisplayModal","Open the autocorrelation chart in search.",vizQueryArray,[null,"calculate autocorrelation",null],searchInfo.timeRange)});var vizOptions=DrilldownLinker.parseVizOptions({category:"charting",type:"column"});Searches.setSearch("acfSeriesPlotSearch",{searchString:["| loadjob $searchBarSearchJobIdToken$"].concat(sharedSearchArray),autostart:!1,onStartCallback:function(){var searchInfo=self.getSearchInfo();Spinners.showLoadingOverlay(acfSeriesPanel.viz.$el),vizQueryArray=[searchInfo.searchString].concat(sharedSearchArray),vizQuerySearch=DrilldownLinker.createSearch(vizQueryArray,searchInfo.timeRange),DrilldownLinker.setSearchDrilldown(acfSeriesPanel.title,vizQuerySearch,vizOptions)},onFinallyCallback:function(){Spinners.hideLoadingOverlay(acfSeriesPanel.viz.$el)}})}(),function(){var sharedSearchArray=["| fit PACF $predictFieldsToken|s$ conf_interval=$confidenceIntervalToken$",'| table Lag "lower$confidenceIntervalToken$(pacf($predictFieldsToken$))" "pacf($predictFieldsToken$)" "upper$confidenceIntervalToken$(pacf($predictFieldsToken$))"'],vizQueryArray=[],vizQuerySearch=null;pacfSeriesPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}),pacfSeriesPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("pacfSearchStringDisplayModal","Open the partial autocorrelation chart in search.",vizQueryArray,[null,"calculate partial autocorrelation",null],searchInfo.timeRange)});var vizOptions=DrilldownLinker.parseVizOptions({category:"charting",type:"column"});Searches.setSearch("pacfSeriesPlotSearch",{searchString:["| loadjob $searchBarSearchJobIdToken$"].concat(sharedSearchArray),autostart:!1,onStartCallback:function(){Spinners.showLoadingOverlay(pacfSeriesPanel.viz.$el);var searchInfo=self.getSearchInfo();vizQueryArray=[searchInfo.searchString].concat(sharedSearchArray),vizQuerySearch=DrilldownLinker.createSearch(vizQueryArray,searchInfo.timeRange),DrilldownLinker.setSearchDrilldown(pacfSeriesPanel.title,vizQuerySearch,vizOptions)},onFinallyCallback:function(){Spinners.hideLoadingOverlay(pacfSeriesPanel.viz.$el)}})}(),function(){var sharedSearchArray=["| eval residual = '$predictFieldsToken$' - prediction","| fit ACF residual conf_interval=$confidenceIntervalToken$",'| table Lag "lower$confidenceIntervalToken$(acf(residual))" "acf(residual)" "upper$confidenceIntervalToken$(acf(residual))"'],vizQueryArray=[],vizQuerySearch=null;
acfResidualPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}),acfResidualPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("acfResidualSearchStringDisplayModal","Open the residual autocorrelation chart in search.",vizQueryArray,[null,"fit ARIMA model","calculate residual (error)","calculate autocorrelation on residuals",null],searchInfo.timeRange)});var vizOptions=DrilldownLinker.parseVizOptions({category:"charting",type:"column"});Searches.setSearch("acfResidualPlotSearch",{searchString:["| loadjob $predictJobIdToken$"].concat(sharedSearchArray),autostart:!1,onStartCallback:function(){var _getVizQuery13=getVizQuery([fitForecastSearchString].concat(sharedSearchArray)),_getVizQuery14=_slicedToArray(_getVizQuery13,2);vizQueryArray=_getVizQuery14[0],vizQuerySearch=_getVizQuery14[1],DrilldownLinker.setSearchDrilldown(acfResidualPanel.title,vizQuerySearch,vizOptions)},onFinallyCallback:function(){Spinners.hideLoadingOverlay(acfResidualPanel.viz.$el)}})}(),function(){var sharedSearchArray=["| eval residual = '$predictFieldsToken$' - prediction","| fit PACF residual conf_interval=$confidenceIntervalToken$",'| table Lag "lower$confidenceIntervalToken$(pacf(residual))" "pacf(residual)" "upper$confidenceIntervalToken$(pacf(residual))"'],vizQueryArray=[],vizQuerySearch=null;pacfResidualPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}),pacfResidualPanel.showSPLButton.on("click",function(){var searchInfo=self.getSearchInfo();(0,_SearchStringDisplay.showSearchStringModal)("pacfResidualSearchStringDisplayModal","Open the partial autocorrelation chart in search.",vizQueryArray,[null,"fit ARIMA model","calculate residual (error)","calculate partial autocorrelation on residuals",null],searchInfo.timeRange)});var vizOptions=DrilldownLinker.parseVizOptions({category:"charting",type:"column"});Searches.setSearch("pacfResidualPlotSearch",{searchString:["| loadjob $predictJobIdToken$"].concat(sharedSearchArray),autostart:!1,onStartCallback:function(){var _getVizQuery15=getVizQuery([fitForecastSearchString].concat(sharedSearchArray)),_getVizQuery16=_slicedToArray(_getVizQuery15,2);vizQueryArray=_getVizQuery16[0],vizQuerySearch=_getVizQuery16[1],DrilldownLinker.setSearchDrilldown(pacfResidualPanel.title,vizQuerySearch,vizOptions)},onFinallyCallback:function(){Spinners.hideLoadingOverlay(pacfResidualPanel.viz.$el)}})}(),setTimeout(updateForm,0),this},loadExperiment:function(runExperiment){var _this2=this;this.stopListening(this.controls.predictFieldsControl,"datachange");var searchInfo=this.getSearchInfo();this.assistantFormView.searchBarControl.setSearchInfo(searchInfo);var mainSearchStage=this.model.experiment.getMainSearchStageModel();if(null!=mainSearchStage){var algorithm=void 0,algorithmParams=void 0,fieldToPredict=void 0;mainSearchStage.get("type")===_Predict2.default.TYPE?(algorithm=_Predict2.default.TYPE,algorithmParams=mainSearchStage.params.getParamsArray(),fieldToPredict=mainSearchStage.fields.getFieldsArray()[0]):(algorithm=mainSearchStage.get("algorithm"),algorithmParams=mainSearchStage.algorithmParams.getParamsArray(),fieldToPredict=mainSearchStage.featureVariables.getFieldsArray()[0]),this.controls.forecastAlgorithmControl.val(algorithm),this.listenToOnce(this.controls.predictFieldsControl,"datachange",_underscoreMltk2.default.partial(function(field,runExp){Forms.setChoiceViewValueIfValid(_this2.controls.predictFieldsControl,field),runExp&&_this2.model.state.trigger("submit")},fieldToPredict,runExperiment)),null!=algorithmParams&&algorithmParams.length&&this.controls.forecastAlgorithmParamsControls.load(algorithmParams)}},setDefaultMainStage:function(){var type=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"predict";if(null==this.model.experiment.getMainSearchStageModel()){var mainSearchStage=void 0;mainSearchStage="predict"===type?new _Predict2.default:new _Fit2.default({algorithm:"ARIMA"}),this.model.experiment.addSearchStages(mainSearchStage)}},controlsTemplate:'\n        <div class="mlts-input">\n            <label>Algorithm</label>\n            <div id="forecastAlgorithmControl"></div>\n        </div>\n        <div class="mlts-input">\n            <label>Field to forecast</label>\n            <div id="predictFieldsControl"></div>\n        </div>\n        <div id="forecastAlgorithmParamsControlsWrapper"></div>\n    ',template:'\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                 <div class="mlts-panel" id="acfSeriesPanel"></div>\n            </div>\n            <div class="mlts-cell">\n                 <div class="mlts-panel" id="pacfSeriesPanel"></div>\n            </div>\n        </div>\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="forecastPanel"></div>\n            </div>\n        </div>\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                 <div class="mlts-panel" id="acfResidualPanel"></div>\n            </div>\n            <div class="mlts-cell">\n                 <div class="mlts-panel" id="pacfResidualPanel"></div>\n            </div>\n        </div>\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="regressionStatisticsPanel">\n                    <div class="mlts-stats-panel">\n                        <div id="r2StatisticPanel"></div>\n                        <div id="rootMeanSquaredErrorStatisticPanel"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="predictionOutliersStatisticPanel"></div>\n            </div>\n        </div>\n    '});new ForecastView}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},671:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[module,exports,__webpack_require__(513),__webpack_require__(646),__webpack_require__(543)],__WEBPACK_AMD_DEFINE_RESULT__=function(module,exports,_underscoreMltk,_AlgorithmParamsGroup2,_ParseAlgorithmParameters){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!=typeof call&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}Object.defineProperty(exports,"__esModule",{value:!0});var _underscoreMltk2=_interopRequireDefault(_underscoreMltk),_AlgorithmParamsGroup3=_interopRequireDefault(_AlgorithmParamsGroup2),_ParseAlgorithmParameters2=_interopRequireDefault(_ParseAlgorithmParameters),_slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;return void 0!==getter?getter.call(receiver):void 0},ForecastParamsGroup=function(_AlgorithmParamsGroup){function ForecastParamsGroup(){return _classCallCheck(this,ForecastParamsGroup),_possibleConstructorReturn(this,(ForecastParamsGroup.__proto__||Object.getPrototypeOf(ForecastParamsGroup)).apply(this,arguments))}return _inherits(ForecastParamsGroup,_AlgorithmParamsGroup),_createClass(ForecastParamsGroup,[{key:"activate",value:function(){var mode=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(this.controls),arguments[1],arguments.length>2&&void 0!==arguments[2]?arguments[2]:"predict");return this.paramsMode=mode,_get(ForecastParamsGroup.prototype.__proto__||Object.getPrototypeOf(ForecastParamsGroup.prototype),"activate",this).apply(this,arguments)}},{key:"load",value:function(){var algorithmParameters=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},parsedParams=_underscoreMltk2.default.isArray(algorithmParameters)?(0,_ParseAlgorithmParameters2.default)(algorithmParameters):algorithmParameters,paramsCopy=_underscoreMltk2.default.extend(parsedParams);if("ARIMA"===this.paramsMode){if(null!=paramsCopy.order){var _paramsCopy$order$spl=paramsCopy.order.split("-"),_paramsCopy$order$spl2=_slicedToArray(_paramsCopy$order$spl,3);paramsCopy.autoregressive=_paramsCopy$order$spl2[0],paramsCopy.integrated=_paramsCopy$order$spl2[1],paramsCopy.moving_average=_paramsCopy$order$spl2[2],delete paramsCopy.order}paramsCopy.forecast_k&&(paramsCopy.future_timespan=paramsCopy.forecast_k,delete paramsCopy.forecast_k)}else paramsCopy.conf_interval=_underscoreMltk2.default.reduce(paramsCopy,function(lastInterval,value,key){return 0===key.indexOf("upper")||0===key.indexOf("lower")?key.substr(5):lastInterval},0);return null!=paramsCopy.future_timespan&&(null!=paramsCopy.holdback&&(paramsCopy.future_timespan-=paramsCopy.holdback),paramsCopy.future_timespan=Math.max(paramsCopy.future_timespan,0)),_get(ForecastParamsGroup.prototype.__proto__||Object.getPrototypeOf(ForecastParamsGroup.prototype),"load",this).call(this,paramsCopy)}},{key:"serialize",value:function(toObject){var serialized=_get(ForecastParamsGroup.prototype.__proto__||Object.getPrototypeOf(ForecastParamsGroup.prototype),"serialize",this).call(this,!0);if(null!=serialized.future_timespan&&null!=serialized.holdback&&(serialized.future_timespan+=serialized.holdback),"ARIMA"===this.paramsMode?(null!=serialized.autoregressive&&null!=serialized.integrated&&null!=serialized.moving_average&&(serialized.order=serialized.autoregressive+"-"+serialized.integrated+"-"+serialized.moving_average),delete serialized.autoregressive,delete serialized.integrated,delete serialized.moving_average,null!=serialized.future_timespan&&(serialized.forecast_k=serialized.future_timespan,delete serialized.future_timespan)):(null!=serialized.conf_interval&&(serialized["upper"+serialized.conf_interval]="upper"+serialized.conf_interval,serialized["lower"+serialized.conf_interval]="lower"+serialized.conf_interval),delete serialized.conf_interval),!toObject){var serializedArray=[];return _underscoreMltk2.default.each(serialized,function(value,key){serializedArray.push(key+"="+value)}),serializedArray}return serialized}}]),ForecastParamsGroup}(_AlgorithmParamsGroup3.default);exports.default=ForecastParamsGroup,module.exports=exports.default}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}});