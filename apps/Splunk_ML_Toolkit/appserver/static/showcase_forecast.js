webpackJsonp([10],[function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__webpack_require__.p=function(){function make_url(){for(var seg,len,output="",i=0,l=arguments.length;i<l;i++)seg=arguments[i].toString(),len=seg.length,len>1&&"/"==seg.charAt(len-1)&&(seg=seg.substring(0,len-1)),output+="/"!=seg.charAt(0)?"/"+seg:seg;if("/"!=output){var segments=output.split("/"),firstseg=segments[1];if("static"==firstseg||"modules"==firstseg){var postfix=output.substring(firstseg.length+2,output.length);output="/"+firstseg+"/@"+window.$C.BUILD_NUMBER,window.$C.BUILD_PUSH_NUMBER&&(output+="."+window.$C.BUILD_PUSH_NUMBER),"app"==segments[2]&&(output+=":"+getConfigValue("APP_BUILD",0)),output+="/"+postfix}}var root=getConfigValue("MRSPARKLE_ROOT_PATH","/"),djangoRoot=getConfigValue("DJANGO_ROOT_PATH",""),locale=getConfigValue("LOCALE","en-US"),combinedPath="";return combinedPath=djangoRoot&&output.substring(0,djangoRoot.length)===djangoRoot?output.replace(djangoRoot,djangoRoot+"/"+locale.toLowerCase()):"/"+locale+output,""==root||"/"==root?combinedPath:root+combinedPath}function getConfigValue(key,defaultValue){if(window.$C&&window.$C.hasOwnProperty(key))return window.$C[key];if(void 0!==defaultValue)return defaultValue;throw new Error("getConfigValue - "+key+" not set, no default provided")}return make_url("/static/app/Splunk_ML_Toolkit/")+"/"}(),__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__("shim/jquery"),__webpack_require__("require/underscore"),__webpack_require__("splunkjs/mvc/checkboxview"),__webpack_require__("splunkjs/mvc/dropdownview"),__webpack_require__("splunkjs/mvc/singleview"),__webpack_require__("splunkjs/mvc/textinputview"),__webpack_require__("splunkjs/mvc/utils"),__webpack_require__("splunkjs/mvc/visualizationregistry"),__webpack_require__(202),__webpack_require__(201),__webpack_require__(205),__webpack_require__(207),__webpack_require__(208),__webpack_require__(209),__webpack_require__(237),__webpack_require__(203),__webpack_require__(212),__webpack_require__(44),__webpack_require__(213),__webpack_require__(241),__webpack_require__(214),__webpack_require__(216),__webpack_require__(206),__webpack_require__(211),__webpack_require__(220)],__WEBPACK_AMD_DEFINE_RESULT__=function(_jquery,_underscore,_checkboxview,_dropdownview,_singleview,_textinputview,_utils,_visualizationregistry,_Footer,_Master,_DrilldownLinker,_Messages,_Modal,_QueryHistoryTable,_SearchStringDisplay,_Spinners,_compactTemplateString,_Options,_ShowcaseHistorySerializer,_ControlValidityStore,_NumberValidator,_AlertModal,_Forms,_Searches,_BaseAssistantView){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj["default"]=obj,newObj}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _taggedTemplateLiteral(strings,raw){return Object.freeze(Object.defineProperties(strings,{raw:{value:Object.freeze(raw)}}))}var _jquery2=_interopRequireDefault(_jquery),_underscore2=_interopRequireDefault(_underscore),_checkboxview2=_interopRequireDefault(_checkboxview),_dropdownview2=_interopRequireDefault(_dropdownview),_singleview2=_interopRequireDefault(_singleview),_textinputview2=_interopRequireDefault(_textinputview),_utils2=_interopRequireDefault(_utils),_visualizationregistry2=_interopRequireDefault(_visualizationregistry),_Footer2=_interopRequireDefault(_Footer),_Master2=_interopRequireDefault(_Master),DrilldownLinker=_interopRequireWildcard(_DrilldownLinker),Messages=_interopRequireWildcard(_Messages),_Modal2=_interopRequireDefault(_Modal),_QueryHistoryTable2=_interopRequireDefault(_QueryHistoryTable),Spinners=_interopRequireWildcard(_Spinners),_compactTemplateString2=_interopRequireDefault(_compactTemplateString),_Options2=_interopRequireDefault(_Options),_ShowcaseHistorySerializer2=_interopRequireDefault(_ShowcaseHistorySerializer),_ControlValidityStore2=_interopRequireDefault(_ControlValidityStore),NumberValidator=_interopRequireWildcard(_NumberValidator),_AlertModal2=_interopRequireDefault(_AlertModal),Forms=_interopRequireWildcard(_Forms),Searches=_interopRequireWildcard(_Searches),_BaseAssistantView2=_interopRequireDefault(_BaseAssistantView),_slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i["return"]&&_i["return"]()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_templateObject=_taggedTemplateLiteral(["| `modvizpredict($predictFieldsToken|s$, $predictAlgorithmToken|s$, $futureTimespanToken|s$,\n                                                $holdbackToken|s$, $periodValueToken|s$, $confidenceIntervalToken|s$)`"],["| \\`modvizpredict($predictFieldsToken|s$, $predictAlgorithmToken|s$, $futureTimespanToken|s$,\n                                                $holdbackToken|s$, $periodValueToken|s$, $confidenceIntervalToken|s$)\\`"]),_templateObject2=_taggedTemplateLiteral(['| loadjob $searchBarSearchJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column \n                               | search column != "column" AND column != "_*"'],['| loadjob $searchBarSearchJobIdToken$\n                               | head 1\n                               | transpose\n                               | fields column \n                               | search column != "column" AND column != "_*"']),_templateObject3=_taggedTemplateLiteral(["| where prediction "," "," \n                                                "," prediction "," ",""],["| where prediction "," "," \n                                                "," prediction "," ",""]),_templateObject4=_taggedTemplateLiteral(["| eval isOutlier = if(prediction!=\"\" AND '$predictFieldsToken$' != \"\"\n                                                        AND ('$predictFieldsToken$' < 'lower$confidenceIntervalToken$(prediction)'\n                                                        OR '$predictFieldsToken$' > 'upper$confidenceIntervalToken$(prediction)'), 1, 0)"],["| eval isOutlier = if(prediction!=\"\" AND '$predictFieldsToken$' != \"\"\n                                                        AND ('$predictFieldsToken$' < 'lower$confidenceIntervalToken$(prediction)'\n                                                        OR '$predictFieldsToken$' > 'upper$confidenceIntervalToken$(prediction)'), 1, 0)"]),_templateObject5=_taggedTemplateLiteral(["| inputlookup ",'_lookup\n                               | eval "Search query"=search_query,\n                               "Field to predict"=field_to_predict, Method=method, Withhold=withhold,\n                               "Forecast next k values"=future_values,"Confidence Interval"=confidence_interval,\n                               "Period"=period,"R² Statistic"=r_squared, "RMSE"=rmse, "# of outliers"=outliers_count,\n                               "Actions"=actions'],["| inputlookup ",'_lookup\n                               | eval "Search query"=search_query,\n                               "Field to predict"=field_to_predict, Method=method, Withhold=withhold,\n                               "Forecast next k values"=future_values,"Confidence Interval"=confidence_interval,\n                               "Period"=period,"R² Statistic"=r_squared, "RMSE"=rmse, "# of outliers"=outliers_count,\n                               "Actions"=actions']),ForecastView=_BaseAssistantView2["default"].extend({headerOptions:{title:"Forecast Time Series",description:'Enter a search (should contain "_time" field with UNIX timestamp values)'},tabOptions:{primaryTabTitle:"Create New Forecast",historyTabTitle:"Load Existing Settings"},submitButtonText:"Forecast",searchBarTooltip:'The events returned should contain a "_time" field with UNIX timestamp values and at least one other numeric field.',render:function(){function setupSearches(){!function(){var searchBarSearch=Searches.getSearchManager("searchBarSearch");searchBarSearch.on("onStartCallback",function(){self.hideErrorMessage(),self.hideResults()}),searchBarSearch.on("onErrorCallback",function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()})}(),function(){Searches.setSearch("predictionFieldsSearch",{searchString:(0,_compactTemplateString2["default"])(_templateObject2),onStartCallback:function(){self.hideErrorMessage()},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()}})}(),function(){function openInSearch(){var _getVizQuery=getVizQuery(),_getVizQuery2=_slicedToArray(_getVizQuery,2);vizQueryArray=_getVizQuery2[0],vizQuerySearch=_getVizQuery2[1],window.open(DrilldownLinker.getUrl("search",vizQuerySearch,vizOptions),"_blank")}function showSPL(e){var modalTitle=forecastPanel.showSPLButton.first().is((0,_jquery2["default"])(e.target))?"Plot forecast":"Calculate the forecast",_getVizQuery3=getVizQuery(),_getVizQuery4=_slicedToArray(_getVizQuery3,2);vizQueryArray=_getVizQuery4[0],vizQuerySearch=_getVizQuery4[1],(0,_SearchStringDisplay.showSearchStringModal)(searchManagerId+"Modal",modalTitle,vizQueryArray,[null,[modvizpredictExplain]],self.model.searchInfo.get("baseTimerange"),vizOptions)}var vizQueryArray=[],vizQuerySearch=null,forecastVizAlertModal=null,modalFieldName$El=(0,_jquery2["default"])("<b>"),vizOptions=DrilldownLinker.parseVizOptions({category:"custom",type:appName+".ForecastViz"});self.assistantFormView.footer.controls.openInSearchButton.on("click",openInSearch),self.assistantFormView.footer.controls.showSPLButton.on("click",showSPL),forecastPanel.openInSearchButton.on("click",openInSearch),forecastPanel.showSPLButton.on("click",showSPL),forecastPanel.scheduleAlertButton.on("click",function(){if(null==forecastVizAlertModal){forecastVizAlertModal=new _Modal2["default"]("forecastVizAlertModal",{title:"Schedule an alert",destroyOnHide:!1,type:"wide"});var futurePredictionsDropdownControl=new _dropdownview2["default"]({id:"futurePredictionsDropdownControl",el:(0,_jquery2["default"])("<span>"),showClearButton:!1,width:150,choices:[{label:"greater than",value:">"},{label:"less than",value:"<"},{label:"between",value:"> AND <"},{label:"not between",value:"< OR >"}]}).render();futurePredictionsDropdownControl.$el.children(".select2-container").css("min-width",futurePredictionsDropdownControl.options.width);var futurePredictionsFirstValueControl=new _textinputview2["default"]({id:"futurePredictionsFirstValueControl",el:(0,_jquery2["default"])("<span>")}).render(),futurePredictionsSecondValueControl=new _textinputview2["default"]({id:"futurePredictionsSecondValueControl",el:(0,_jquery2["default"])("<span>")}).render();futurePredictionsDropdownControl.on("change",function(value){">"===value||"<"===value?futurePredictionsFirstValueControl.$el.nextAll().hide():futurePredictionsFirstValueControl.$el.nextAll().show()}),forecastVizAlertModal.body.addClass("mlts-modal-form-inline").append((0,_jquery2["default"])("<p>").append("Alert me when the future predicted value of ",modalFieldName$El," is"),futurePredictionsDropdownControl.$el,futurePredictionsFirstValueControl.$el,(0,_jquery2["default"])("<p>").text("and"),futurePredictionsSecondValueControl.$el);var cancelButton=(0,_jquery2["default"])("<button>").addClass("mlts-modal-cancel").attr({type:"button","data-dismiss":"modal"}).addClass("btn btn-default mlts-modal-cancel").text("Cancel"),submitButtonText="Next",submitButton=(0,_jquery2["default"])("<button>").attr({type:"button"}).addClass("btn btn-primary mlts-modal-submit").text(submitButtonText);forecastVizAlertModal.footer.append(cancelButton,submitButton.on("click",function(){forecastVizAlertModal.removeAlert();var valueRange=futurePredictionsDropdownControl.val(),searchString="",firstValue=futurePredictionsFirstValueControl.val(),isValid=NumberValidator.validate(firstValue);if(Messages.setFormInputStatus(futurePredictionsFirstValueControl,isValid),">"===valueRange||"<"===valueRange)searchString="| where prediction "+valueRange+" "+firstValue;else if("> AND <"===valueRange||"< OR >"===valueRange){var secondValue=futurePredictionsSecondValueControl.val(),secondValueValid=NumberValidator.validate(secondValue);Messages.setFormInputStatus(futurePredictionsSecondValueControl,secondValueValid),isValid=isValid&&secondValueValid,valueRange=valueRange.split(" "),searchString=(0,_compactTemplateString2["default"])(_templateObject3,valueRange[0],Math.min(firstValue,secondValue),valueRange[1],valueRange[2],Math.max(firstValue,secondValue))}searchString.length>0&&(isValid?(searchString=Forms.parseTemplate([self.model.searchInfo.get("baseSearchString")].concat([predictSearchString,"| tail $futurePointsToken$",searchString]).join(" ")),submitButton.attr("disabled",!0).text("Loading..."),new _AlertModal2["default"]({searchString:searchString}).done(function(alertModal){forecastVizAlertModal.isShown()?(forecastVizAlertModal.hide(),alertModal.render().appendTo((0,_jquery2["default"])("body")).show()):alertModal.remove()}).fail(function(message){forecastVizAlertModal.setAlert(message),submitButton.attr("disabled",!1).text(submitButtonText)})):forecastVizAlertModal.setAlert("Predicted value must be a number."))})),forecastVizAlertModal.$el.on("show.bs.modal",function(){submitButton.attr("disabled",!1).text(submitButtonText),forecastVizAlertModal.removeAlert(),Messages.setFormInputStatus([futurePredictionsFirstValueControl,futurePredictionsSecondValueControl],!0),modalFieldName$El.text(Forms.getToken("predictFieldsToken")),futurePredictionsDropdownControl.val(">"),futurePredictionsFirstValueControl.val(0),futurePredictionsSecondValueControl.val(0)})}forecastVizAlertModal.show()}),Searches.setSearch(searchManagerId,{autostart:!1,targetJobIdTokenName:"predictJobIdToken",searchString:"| loadjob $searchBarSearchJobIdToken$ "+predictSearchString,onStartCallback:function(){Spinners.showLoadingOverlay(forecastPanel.viz.$el),self.hideErrorMessage(),updateForm(!0),currentSampleSearch=null;var searchManager=Searches.getSearchManager(searchManagerId),jobId=Searches.getSid(searchManager),searchAttributes=Searches.getSearchManager("searchBarSearch").search.attributes,collection={_time:parseInt((new Date).valueOf()/1e3,10),search_query:searchAttributes.search,earliest_time:searchAttributes.earliest_time,latest_time:searchAttributes.latest_time,field_to_predict:predictFieldsControl.val(),method:predictAlgorithmControl.val(),withhold:holdbackControl.val(),future_values:futureTimespanControl.val(),confidence_interval:confidenceIntervalControl.val(),period:periodCheckboxControl.val()&&periodValueControl.val()||0};historySerializer.persist(jobId,collection);var _getVizQuery5=getVizQuery(),_getVizQuery6=_slicedToArray(_getVizQuery5,2);vizQueryArray=_getVizQuery6[0],vizQuerySearch=_getVizQuery6[1],DrilldownLinker.setSearchDrilldown(forecastPanel.title,vizQuerySearch,vizOptions)},onDoneCallback:function(){self.showResults(),Searches.getSearchManager("predictionOutliersSearch").startSearch(),Searches.getSearchManager("regressionstatisticsSearch").startSearch()},onErrorCallback:function(errorMessage){self.showErrorMessage(errorMessage),self.hideResults()},onFinallyCallback:function(){updateForm(!1),Spinners.hideLoadingOverlay(forecastPanel.viz.$el)}})}(),function(){var identifyOutliersSearchQueryArray=[(0,_compactTemplateString2["default"])(_templateObject4)],findOutliersSearchQueryArray=identifyOutliersSearchQueryArray.concat(["| where isOutlier=1","| fields - isOutlier"]),outlierExplain="find the outliers among events that have both an actual and a predicted value",vizQueryArray=[],vizQuerySearch=null,outliersOverTimeVizOptions=DrilldownLinker.parseVizOptions({category:"custom",type:appName+".LinesViz"});predictionOutliersStatisticPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}),predictionOutliersStatisticPanel.showSPLButton.on("click",function(){(0,_SearchStringDisplay.showSearchStringModal)("predictionOutliersSearchStringDisplayModal","Show forecast outliers",vizQueryArray,[null,modvizpredictExplain,outlierExplain],self.model.searchInfo.get("baseTimerange"))}),predictionOutliersStatisticPanel.plotOutliersOverTimeButton.on("click",function(){var _getVizQuery7=getVizQuery([predictSearchString].concat(identifyOutliersSearchQueryArray)),_getVizQuery8=_slicedToArray(_getVizQuery7,2);vizQueryArray=_getVizQuery8[0],vizQuerySearch=_getVizQuery8[1];var outliersOverTimeSearch=DrilldownLinker.createSearch(vizQueryArray.concat(["| table _time, isOutlier"]),self.model.searchInfo.get("baseTimerange"));window.open(DrilldownLinker.getUrl("search",outliersOverTimeSearch,outliersOverTimeVizOptions),"_blank")}),Searches.setSearch("predictionOutliersSearch",{autostart:!1,searchString:["| loadjob $predictJobIdToken$"].concat(findOutliersSearchQueryArray,["| stats count"]),onStartCallback:function(){Spinners.showLoadingOverlay(predictionOutliersStatisticPanel.viz.$el,smallLoaderScale);var _getVizQuery9=getVizQuery([predictSearchString].concat(findOutliersSearchQueryArray)),_getVizQuery10=_slicedToArray(_getVizQuery9,2);vizQueryArray=_getVizQuery10[0],vizQuerySearch=_getVizQuery10[1],DrilldownLinker.setSearchDrilldown(predictionOutliersStatisticPanel.title,vizQuerySearch)},onDataCallback:function(data){var searchManager=Searches.getSearchManager(searchManagerId),jobId=Searches.getSid(searchManager),resultIndex=data.fields.indexOf("count"),collection={outliers_count:data.rows[0][resultIndex]};historySerializer.persist(jobId,collection)},onFinallyCallback:function(){Spinners.hideLoadingOverlay(predictionOutliersStatisticPanel.viz.$el)}})}(),function(){var regressionstatisticsSearchQueryArray=['| where prediction!="" AND \'$predictFieldsToken$\' != ""',"| `regressionstatistics($predictFieldsToken|s$, prediction)`"],vizQueryArray=[],vizQuerySearch=null;regressionStatisticsPanel.openInSearchButton.on("click",function(){window.open(DrilldownLinker.getUrl("search",vizQuerySearch),"_blank")}),regressionStatisticsPanel.showSPLButton.on("click",function(){(0,_SearchStringDisplay.showSearchStringModal)("regressionstatisticsSearchStringDisplayModal","Compute R² and root mean squared error (RMSE)",vizQueryArray,[null,modvizpredictExplain,null,"use the `regressionstatistics` macro to compute R² and RMSE"],self.model.searchInfo.get("baseTimerange"))}),Searches.setSearch("regressionstatisticsSearch",{autostart:!1,searchString:["| loadjob $predictJobIdToken$"].concat(regressionstatisticsSearchQueryArray),onStartCallback:function(){Spinners.showLoadingOverlay(regressionStatisticsPanel.spinnerAnchor,smallLoaderScale);var _getVizQuery11=getVizQuery([predictSearchString].concat(regressionstatisticsSearchQueryArray)),_getVizQuery12=_slicedToArray(_getVizQuery11,2);vizQueryArray=_getVizQuery12[0],vizQuerySearch=_getVizQuery12[1],DrilldownLinker.setSearchDrilldown(r2StatisticPanel.title,vizQuerySearch),DrilldownLinker.setSearchDrilldown(rootMeanSquaredErrorStatisticPanel.title,vizQuerySearch)},onDataCallback:function(data){var searchManager=Searches.getSearchManager(searchManagerId),jobId=Searches.getSid(searchManager),r2Index=data.fields.indexOf("rSquared"),rmseIndex=data.fields.indexOf("RMSE"),collection={rmse:data.rows[0][rmseIndex],r_squared:data.rows[0][r2Index]};historySerializer.persist(jobId,collection)},onFinallyCallback:function(){Spinners.hideLoadingOverlay(regressionStatisticsPanel.spinnerAnchor)}})}()}function updatePeriodValueControlValidity(){if(null!=periodCheckboxControl&&null!=periodValueControl){var periodValue=periodValueControl.val(),hasPeriod=periodCheckboxControl.val();hasPeriod&&(isNaN(periodValue)||periodValue<=0)?(controlValidity.set(periodValueControl.id,!1),Messages.setTextInputMessage(periodValueControl,"Period value must be a positive integer.")):(controlValidity.set(periodValueControl.id,!0),Messages.removeTextInputMessage(periodValueControl)),periodValueControl.settings.set("disabled",!hasPeriod),updateForm()}}function getVizQuery(){var sharedSearchArray=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[predictSearchString],vizQueryArray=[self.model.searchInfo.get("baseSearchString")].concat(sharedSearchArray),vizQuerySearch=DrilldownLinker.createSearch(vizQueryArray,self.model.searchInfo.get("baseTimerange"));return[vizQueryArray,vizQuerySearch]}function activatePredictionSearch(){!self.assistantFormView.footer.getDisabled()&&controlValidity.getAll()&&(currentSampleSearch=null,Searches.startSearch(searchManagerId))}function updateForm(newIsRunningValue){if(null!=newIsRunningValue&&(isRunning=newIsRunningValue),predictFieldsControl.settings.set("disabled",isRunning),predictAlgorithmControl.settings.set("disabled",isRunning),periodCheckboxControl.settings.set("disabled",isRunning),periodValueControl.settings.set("disabled",isRunning||!periodCheckboxControl.val()),holdbackControl.settings.set("disabled",isRunning),futureTimespanControl.settings.set("disabled",isRunning),confidenceIntervalControl.settings.set("disabled",isRunning),isRunning)self.assistantFormView.footer.setDisabled(!0,"Forecasting...");else{var predictFieldsToken=Forms.getToken("predictFieldsToken"),fieldsValid=null!=predictFieldsToken&&predictFieldsToken.length>0;self.assistantFormView.footer.setDisabled(!fieldsValid)}}var _this=this,self=this;_BaseAssistantView2["default"].prototype.render.call(this);var _utils$getPageInfo=_utils2["default"].getPageInfo(),appName=_utils$getPageInfo.app,showcaseName=_utils$getPageInfo.page,searchManagerId="predictSearch",smallLoaderScale=_Options2["default"].getOptionByName("smallLoaderScale"),defaultVizHeight=_Options2["default"].getOptionByName("defaultVizHeight"),predictSearchString=(0,_compactTemplateString2["default"])(_templateObject),modvizpredictExplain="forecast using a macro that formats the `predict` command output for a different visualization",currentSampleSearch=null,isRunning=!1,controlValidity=new _ControlValidityStore2["default"],historyCollectionId=showcaseName+"_history",historySerializer=new _ShowcaseHistorySerializer2["default"](historyCollectionId,{_time:null,search_query:null,earliest_time:null,latest_time:null,field_to_predict:null,method:null,withhold:null,future_values:null,confidence_interval:null,period:null,r_squared:null,rmse:null,outliers_count:null},function(){Searches.getSearchManager("queryHistorySearch").startSearch()});!function(){Searches.setSearch("queryHistorySearch",{searchString:(0,_compactTemplateString2["default"])(_templateObject5,showcaseName)})}();new _QueryHistoryTable2["default"](this.$el.find("#queryHistoryPanel"),"queryHistorySearch",historyCollectionId,["Actions","_time","Search query","Field to predict","Method","Withhold","Forecast next k values","Confidence Interval","Period","R² Statistic","RMSE","# of outliers"],this.submitButtonText,function(params,autostart){var savedSearch={};savedSearch.value=params.data["row.search_query"],savedSearch.earliestTime=params.data["row.earliest_time"],savedSearch.latestTime=params.data["row.latest_time"],savedSearch.algorithm=params.data["row.method"],savedSearch.fieldToPredict=params.data["row.field_to_predict"],savedSearch.holdback=params.data["row.withhold"],savedSearch.futureTimespan=params.data["row.future_values"],savedSearch.confidenceInterval=params.data["row.confidence_interval"],savedSearch.period=params.data["row.period"],savedSearch.autostart=autostart,loadSavedSearch(savedSearch),self.assistantFormView.tabs.activate("primaryTab")});this.assistantFormView.searchBarControl.events.on("change",function(){Forms.clearChoiceView(predictFieldsControl,!0),Forms.unsetToken("predictFieldsToken"),updateForm()});var predictFieldsControl=function(){var predictFieldsControl=new _dropdownview2["default"]({id:"predictFieldsControl",el:_this.$el.find("#predictFieldsControl"),managerid:"predictionFieldsSearch",labelField:"column",valueField:"column",showClearButton:!1});return predictFieldsControl.$el.prev("label").tooltip({title:"Select the numeric field to forecast."}),predictFieldsControl.on("datachange",function(){if(null!=currentSampleSearch){var choices=Forms.getChoiceViewChoices(predictFieldsControl);choices.indexOf(currentSampleSearch.fieldToPredict)>=0?predictFieldsControl.val(currentSampleSearch.fieldToPredict):currentSampleSearch=null}}),predictFieldsControl.on("change",function(value){Forms.setToken("predictFieldsToken",value),updateForm(),null!=value&&(currentSampleSearch.autostart!==!1?self.assistantFormView.footer.controls.submitButton.trigger("submit"):currentSampleSearch=null)}),predictFieldsControl.render(),predictFieldsControl}(),predictAlgorithmControl=function(){var predictAlgorithmControl=new _dropdownview2["default"]({id:"predictAlgorithmControl",el:_this.$el.find("#predictAlgorithmControl"),labelField:"label",valueField:"value",selectFirstChoice:!0,showClearButton:!1,choices:[{label:"LLP5 (combines LLT and LLP)",value:"LLP5"},{label:"LL (local level)",value:"LL"},{label:"LLP (seasonal local level)",value:"LLP"},{label:"LLT (local level trend)",value:"LLT"}]});return predictAlgorithmControl.$el.prev("label").tooltip({title:"Select the appropriate method, which will depend on whether your data has long-term trends, periodicity, or both."}),predictAlgorithmControl.on("change",function(value){Forms.setToken("predictAlgorithmToken",value)}),predictAlgorithmControl.render(),predictAlgorithmControl}(),holdbackControl=function(){var holdbackControl=new _textinputview2["default"]({id:"holdbackControl",el:_this.$el.find("#holdbackControl")});return holdbackControl.$el.prev("label").tooltip({html:!0,title:"Withholding allows us to compare the forecast against known values (those that were withheld). This comparison is done using the R<sup>2</sup> and RMSE statistics and the Forecast Outliers, below."}),holdbackControl.on("change",function(value){var holdback=parseInt(value,10);if(isNaN(holdback)||holdback<0)controlValidity.set(holdbackControl.id,!1),Messages.setTextInputMessage(this,"Withhold value must be a positive integer.");else if(controlValidity.set(holdbackControl.id,!0),Messages.removeTextInputMessage(this),holdbackControl.val(holdback),Forms.setToken("holdbackToken",holdback),null!=futureTimespanControl){var futureTimespan=parseInt(futureTimespanControl.val(),10);!isNaN(futureTimespan)&&futureTimespan>=0&&Forms.setToken("futureTimespanToken",holdback+futureTimespan)}updateForm()}),holdbackControl.render(),holdbackControl}(),futureTimespanControl=function(){var futureTimespanControl=new _textinputview2["default"]({id:"futureTimespanControl",el:_this.$el.find("#futureTimespanControl")});return futureTimespanControl.$el.prev("label").tooltip({title:"The further into the future the forecast, the less accurate it is likely to be."}),futureTimespanControl.on("change",function(value){var futureTimespan=parseInt(value,10);if(isNaN(futureTimespan)||futureTimespan<0)controlValidity.set(futureTimespanControl.id,!1),Messages.setTextInputMessage(this,"Forecast value must be a positive integer.");else if(controlValidity.set(futureTimespanControl.id,!0),Messages.removeTextInputMessage(this),futureTimespanControl.val(futureTimespan),null!=holdbackControl){var holdback=parseInt(holdbackControl.val(),10);if(!isNaN(holdback)&&holdback>=0){var actualFutureTimespan=futureTimespan+holdback;Forms.setToken("futureTimespanToken",actualFutureTimespan),Forms.setToken("futurePointsToken",futureTimespan)}}updateForm()}),futureTimespanControl.render(),futureTimespanControl}(),confidenceIntervalControl=function(){var confidenceIntervalControl=new _textinputview2["default"]({id:"confidenceIntervalControl",el:_this.$el.find("#confidenceIntervalControl")});return confidenceIntervalControl.$el.prev("label").tooltip({title:"Specify a value between 0 and 100, where a larger value means a greater tolerance for forecast uncertainty."}),confidenceIntervalControl.on("change",function(value){var confidenceInterval=parseInt(value,10);isNaN(confidenceInterval)||confidenceInterval<0||confidenceInterval>=100?(controlValidity.set(confidenceIntervalControl.id,!1),Messages.setTextInputMessage(this,"Confidence interval percentile value must be a integer between 0 and 99.")):(controlValidity.set(confidenceIntervalControl.id,!0),Messages.removeTextInputMessage(this),confidenceIntervalControl.val(confidenceInterval),Forms.setToken("confidenceIntervalToken",confidenceInterval)),updateForm()}),confidenceIntervalControl.render(),confidenceIntervalControl}(),periodCheckboxControl=function(){var periodCheckboxControl=new _checkboxview2["default"]({id:"periodCheckboxControl",el:_this.$el.find("#periodCheckboxControl"),"default":!1});return periodCheckboxControl.$el.parent("label").tooltip({title:"If the data has a known periodicity, specify it here. For example, hourly data may have a period of 24 (one day)."}),periodCheckboxControl.on("change",function(hasPeriod){updatePeriodValueControlValidity(),hasPeriod?null!=periodValueControl.val()&&periodValueControl.trigger("change",periodValueControl.val()):Forms.setToken("periodValueToken","")}),Forms.setToken("periodValueToken",""),periodCheckboxControl.render(),periodCheckboxControl}(),periodValueControl=function(){var periodValueControl=new _textinputview2["default"]({id:"periodValueControl",disabled:!0,el:_this.$el.find("#periodValueControl")});return periodValueControl.on("change",function(value){if(null==value)Forms.setToken("periodValueToken","");else{var periodValue=parseInt(value,10);Forms.setToken("periodValueToken","period="+periodValue)}updatePeriodValueControlValidity()}),periodValueControl.render(),periodValueControl}();this.assistantFormView.footer.controls.submitButton.on("submit",function(){activatePredictionSearch()});var regressionStatisticsPanel=function(){var footer=new _Footer2["default"](_this.$el.find("#regressionStatisticsPanel"));return footer.spinnerAnchor=footer.footer.parent(".mlts-panel"),footer}(),r2StatisticPanel=function(){return new _Master2["default"]({el:_this.$el.find("#r2StatisticPanel"),title:"R<sup>2</sup> Statistic",tooltip:{html:!0,title:"The square of the correlation coefficient between the forecasted and actual values. Better forecasts have an R<sup>2</sup> closer to 1."},viz:_singleview2["default"],vizOptions:{id:"r2StatisticViz",managerid:"regressionstatisticsSearch",field:"rSquared",numberPrecision:"0.0000",height:30},footerButtons:!1})}(),rootMeanSquaredErrorStatisticPanel=function(){return new _Master2["default"]({el:_this.$el.find("#rootMeanSquaredErrorStatisticPanel"),title:"Root Mean Squared Error (RMSE)",tooltip:"The quadratic mean of the prediction errors (residuals). Better models have a smaller RMSE.",viz:_singleview2["default"],vizOptions:{id:"rootMeanSquaredErrorStatisticViz",managerid:"regressionstatisticsSearch",field:"RMSE",numberPrecision:"0.00",height:30},footerButtons:!1})}(),predictionOutliersStatisticPanel=function(){var assistantPanel=new _Master2["default"]({el:_this.$el.find("#predictionOutliersStatisticPanel"),title:"Forecast Outliers",tooltip:"Number of values in the test period that fall outside the confidence interval.",viz:_singleview2["default"],vizOptions:{id:"predictionOutliersStatisticViz",managerid:"predictionOutliersSearch",field:"count",numberPrecision:"0",height:30}});return assistantPanel.plotOutliersOverTimeButton=(0,_jquery2["default"])("<button>").addClass("btn btn-default mlts-plot-outliers-over-time").text("Plot Outliers Over Time"),assistantPanel.footer.append(assistantPanel.plotOutliersOverTimeButton),assistantPanel}(),forecastPanel=function(){var ForecastViz=_visualizationregistry2["default"].getVisualizer(appName,"ForecastViz");
return new _Master2["default"]({el:_this.$el.find("#forecastPanel"),title:"Forecast",tooltip:'The input data, forecast, and confidence intervals. Values to the right of the "training-test split" line were not shown to the algorithm. Narrower confidence intervals mean more confident predictions.',viz:ForecastViz,vizOptions:{id:"forecastViz",height:defaultVizHeight,managerid:searchManagerId},footerButtons:{scheduleAlertButton:!0}})}(),loadSavedSearch=function(sampleSearch){currentSampleSearch=_underscore2["default"].extend({},{algorithm:"LLP",holdback:0,futureTimespan:0,confidenceInterval:95},sampleSearch),_this.assistantFormView.searchBarControl.setProperties(sampleSearch.value,sampleSearch.earliestTime,sampleSearch.latestTime);var holdback=currentSampleSearch.holdback,futureTimespan=currentSampleSearch.futureTimespan,algorithm=currentSampleSearch.algorithm,confidenceInterval=currentSampleSearch.confidenceInterval;if(null!=currentSampleSearch.period&&0!=currentSampleSearch.period){var period=currentSampleSearch.period;periodCheckboxControl.val(!0),periodValueControl.val(period)}else periodValueControl.settings.unset("value"),periodValueControl.settings.set("disabled",!0),periodCheckboxControl.val(!1);holdbackControl.val(holdback),futureTimespanControl.val(futureTimespan),predictAlgorithmControl.val(algorithm),confidenceIntervalControl.val(confidenceInterval)};return updatePeriodValueControlValidity(),setupSearches(),this.sampleSearchDeferred.done(loadSavedSearch),setTimeout(updateForm,0),this},controlsTemplate:'\n        <div class="mlts-input">\n            <label>Field to forecast</label>\n            <div id="predictFieldsControl"></div>\n        </div>\n        <div class="mlts-input">\n            <label>Forecasting method</label>\n            <div id="predictAlgorithmControl"></div>\n        </div>\n        <div class="mlts-input">\n            <label>Withhold latest k values</label>\n            <div id="holdbackControl"></div>\n        </div>\n        <div class="mlts-input">\n            <label>Forecast next k values</label>\n            <div id="futureTimespanControl"></div>\n        </div>\n        <div class="mlts-input">\n            <label>Confidence interval (%)</label>\n            <div id="confidenceIntervalControl"></div>\n        </div>\n        <div class="mlts-input">\n            <div class="checkbox">\n                <label><div id="periodCheckboxControl"></div>Period (optional)</label>\n            </div>\n            <div id="periodValueControl"></div>\n        </div>\n    ',template:'\n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="forecastPanel"></div>\n            </div>\n        </div>\n        \n        <div class="mlts-row mlts-results-row">\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="regressionStatisticsPanel">\n                    <div class="mlts-stats-panel">\n                        <div id="r2StatisticPanel"></div>\n                        <div id="rootMeanSquaredErrorStatisticPanel"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="mlts-cell">\n                <div class="mlts-panel" id="predictionOutliersStatisticPanel"></div>\n            </div>\n        </div>\n    '}),forecastView=new ForecastView;forecastView.deferreds.viewReady.done(function(layout){layout.getContainerElement().appendChild(forecastView.render().el)})}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),!(void 0!==__WEBPACK_AMD_DEFINE_RESULT__&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}]);